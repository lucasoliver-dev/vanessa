(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[98],{1449:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(1),o=r(853),a=r(1258),i=r(119),s=r(3),c=a.a,l=Object(i.c)((function(e){return Object(n.__assign)(Object(n.__assign)({},e),{disableGlobalClassNames:!0})})),u=Object(o.a)((function(e){return s.createElement(c,{settings:{theme:l(e.theme)}},e.children)}))},1555:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(3),o=r(105),a=r(239),i=r(627),s=r(735),c=r(158),l=r(1391),u=r(742),d=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};function p(e,t,r,n){var o=function(e,t,r){var n=i.a.apply(void 0,d([f],r,!1));return e(t,n)}(e,t,Object(a.keys)(r));return h(o,n)(r)}var m=/(.*?)<<<(.*?)>>>/g,f=function(e){return"<<<".concat(e,">>>")},h=Object(c.a)((function(e,t){var r=Object(l.a)(e,t),a=Object(s.a)(r,m);if(!a.length)return function(){return[r].filter(Boolean)};var i=a[a.length-1],c=r.substr(i.index+i[0].length),d=Object(u.a)(a.map((function(e,t){e[0];var r=e[1],o=e[2];return[function(){return r||null},function(e){var r=e[o];return r?"string"==typeof r?r:n.cloneElement(r,{key:t}):null}]}))).concat((function(){return c||null}));return function(e){return Object(o.filterOutNull)(d.map((function(t){return t(e)})))}}));function g(e){var t=p(e.resolveString,e.text,e.placeholders,e.count);return n.createElement(n.Fragment,null,t.map((function(t,r){return e.wrapper?e.wrapper(t,r):t})))}},1577:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(130),o=r(853),a=r(2533),i=r(15),s=r(3),c=r(1449),l=r(172),u=r(14),d=r(119),p=Object(d.c)((function(e,t){var r=document.documentElement&&document.documentElement.getAttribute("dir"),n=e.palette;return Object(u.db)({root:{position:"absolute",width:"".concat(t,"px"),height:"".concat(t,"px"),transform:r===l.a.RightToLeft?"translate(50%, 100%)":"translate(-50%, 100%)",zIndex:19,boxSizing:"border-box",top:"-".concat(Math.ceil(.1*t),"px"),padding:0,color:n.white,backgroundColor:n.neutralSecondary,borderRadius:"50%",border:"2px solid ".concat(n.white),backgroundClip:"padding-box"},icon:{color:n.white,fontSize:"".concat(Math.floor(.5*t),"px")},rootHovered:{width:"".concat(Math.ceil(1.1*t),"px"),height:"".concat(Math.ceil(1.1*t),"px"),top:"-".concat(Math.ceil(.25*t),"px"),backgroundColor:n.neutralPrimaryAlt}})}));var m=Object(o.a)((function(e){var t=e.children,r=e.onClick,o=e.title,l=e.size,u=e.theme,d=function(e){switch(e){case i.c.extraLarge:case i.c.size100:return 36;case i.c.large:case i.c.size72:return 28;case i.c.size120:return 44;case i.c.tiny:case i.c.extraExtraSmall:case i.c.extraSmall:case i.c.small:case i.c.regular:case i.c.size8:case i.c.size10:case i.c.size16:case i.c.size24:case i.c.size28:case i.c.size32:case i.c.size40:case i.c.size48:case i.c.size56:return 0;default:return Object(n.a)(e)}}(l);if(0===d)return null;var m=p(u,d);return s.createElement(c.a,null,s.createElement(a.a,{iconProps:{iconName:"Camera"},onClick:r,"data-log-name":"PhotoPickerButton",ariaLabel:o,title:o,styles:m}),t)}))},1789:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(5),o=r.n(n),a=r(3),i=r(1555),s=function(){return(s=o.a||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function c(e){return a.createElement(i.a,s({resolveString:function(e,t){return e(t)}},e))}},2842:function(e,t,r){"use strict";r.r(t),r.d(t,"ContactEditor",(function(){return Ho})),r.d(t,"ContactEditorStore",(function(){return Lr}));r(2236),r(2238),r(2239),r(2240);var n=r(539),o=r(130),a=r(158),i=r(714),s=r(490),c=r(853),l=r(2533),u=r(2894),d=r(2046),p=r(2670),m=r(2893),f=r(15),h=r(923),g=r(338),b=r(474),y=r(3),P=r(132),S=r(4);function E(e,t,r){return Object(S.a)("".concat("ContactEditor",".").concat(e),{featureName:"ContactEditor",getLogProperties:function(){return t?{}:null},exportOptions:r})}var v=E("StartEditingContact",!0),x=E("StartCreateContact",!0),A=E("LoadCompleted",!0),N=E("LoadFailed",!0),O=E("AddedChangeSetFromPersona",!0),C=E("NameAdded",!0),w=E("NameUpdated",!1),k=E("PhoneAdded",!0),j=E("PhoneUpdated",!0),V=E("AddressEditStarted",!0),D=E("AddressAdded",!0),U=E("AddressUpdated",!0),T=E("OtherContactPropAdded",!0),L=E("OtherContactPropUpdated",!0),B=E("OtherContactDatePropRemoved",!0),M=E("ImAdded",!0),W=E("ImUpdated",!0),R=E("EmailAdded",!0),I=E("EmailBlurred",!0),F=E("EmailUpdated",!0),H=E("PersonalNotesAdded",!0),Y=E("PersonalNotesUpdated",!0),_=E("WorkDetailAdded",!0),G=E("WorkDetailUpdated",!0),z=E("SaveButtonClicked",!0,{exportType:"UserInteraction",exportName:"EditedContact"}),K=E("SaveButtonClickedWithErrors",!0),X=E("CancelButtonClicked",!0),$=E("NotSaveButtonInDialogClicked",!0),J=E("RetryButtonInDialogClicked",!0),q=E("CancelButtonInDialogClicked",!0),Q=(E("ScrolledToTop",!0),E("SaveConfirmationTriggered",!0)),Z=E("ExternalCancelTriggered",!0),ee=E("SaveCompleted",!0),te=E("CancelCompleted",!0),re=E("SaveFailed",!0),ne=E("FavoriteStarClicked",!0),oe=E("ProfilePhotoUpdated",!0),ae=E("ResetErrorState",!0),ie=r(10),se=r(105),ce=r(239),le=r(975),ue=r(982),de=r(1284),pe=r(2664),me=r(334),fe=r(840),he=r.n(fe),ge=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},be=["DisplayNamePrefix","GivenName","MiddleName","Surname","Generation","Nickname","YomiFirstName","YomiLastName"],ye=["GivenName","Surname","Nickname","MiddleName","DisplayNamePrefix","Generation","YomiFirstName","YomiLastName"],Pe=["PersonaPersonalHomePages","PersonaSpouseNames","PersonaManagers","PersonaAssistantNames","PersonaBusinessHomePages","PersonaBirthdays","PersonaWeddingAnniversaries"],Se=["PersonaPersonalHomePages","PersonaSpouseNames","PersonaManagers","PersonaAssistantNames","PersonaBusinessHomePages","PersonaSchools","PersonaLocations","PersonaHobbies","PersonaBirthdays","PersonaWeddingAnniversaries"],Ee=["PersonaDisplayNamePrefixes","PersonaGivenNames","PersonaMiddleNames","PersonaSurnames","PersonaGenerations","PersonaNicknames","PersonaYomiFirstNames","PersonaYomiLastNames"],ve=["PersonaHomePhones","PersonaHomePhones2","PersonaMobilePhones","PersonaCarPhones","PersonaBusinessPhoneNumbers","PersonaBusinessPhoneNumbers2"],xe=["PersonaOrganizationMainPhones","PersonaPagers","PersonaOtherTelephones","PersonaOtherPhones2","PersonaHomeFaxes","PersonaWorkFaxes","PersonaOtherFaxes","PersonaAssistantPhoneNumbers","PersonaCallbackPhones","PersonaRadioPhones","PersonaTelexNumbers","PersonaTTYTDDPhoneNumbers"],Ae=ge(ge([],ve,!0),xe,!0),Ne=["PersonaEmails1","PersonaEmails2","PersonaEmails3"],Oe=["PersonaImAddresses"],Ce=ge(ge(ge([],["PersonaCompanyNames","PersonaTitles"],!0),["PersonaDepartments","PersonaOfficeLocations"],!0),["PersonaYomiCompanyNames"],!0),we=["PersonaHomeAddresses","PersonaBusinessAddresses","PersonaOtherAddresses"],ke=["PersonaBodies"];function je(e){return We(e.propertyUri)}var Ve=ge(ge(ge(ge(ge(ge(ge(ge([],Ee,!0),Ne,!0),Oe,!0),Ae,!0),Ce,!0),we,!0),Se,!0),ke,!0);function De(e){return-1!==Ee.indexOf(e)}function Ue(e){return-1!==Ne.indexOf(e)}function Te(e){return-1!==Oe.indexOf(e)}function Le(e){return-1!==ve.indexOf(e)}function Be(e){return-1!==xe.indexOf(e)}function Me(e){return-1!==Ce.indexOf(e)}function We(e){return-1!==we.indexOf(e)}function Re(e){return-1!==Se.indexOf(e)}function Ie(e){return-1!==ke.indexOf(e)}function Fe(e){return-1!==Ve.indexOf(e)}function He(e){switch(e){case"PersonaWeddingAnniversariesLocal":case"PersonaBirthdaysLocal":case"PersonaWeddingAnniversaries":case"PersonaBirthdays":return!0;default:return!1}}var Ye=r(2),_e=Ye.declareString("contact-editor.contactEditorStrings.attributionForGAL"),Ge=Ye.declareStringWithPlaceholders("contact-editor.contactEditorStrings.attributionForContactFolder");function ze(e,t){return e&&t?Object(le.a)(Object(se.filterOutNull)(e.map((function(e){var r=Object(de.a)(t,(function(t){return t.Id===e}));return!r||r.IsHidden?null:"GAL"===r.DisplayName?_e():"Outlook"===r.DisplayName&&r.FolderName?Ge({folder:r.FolderName}):r.FolderName?"".concat(r.DisplayName," - ").concat(r.FolderName):r.DisplayName})))):[]}var Ke=function(){return(Ke=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Xe={AddNameSubmenu:Ye.declareString("contact-editor.contactEditorStrings.labelAddNameSubmenu"),AddPhoneSubmenu:Ye.declareString("contact-editor.contactEditorStrings.labelAddPhoneSubmenu"),AddPhoneOtherSubmenu:Ye.declareString("contact-editor.contactEditorStrings.labelAddPhoneOtherSubmenu"),AddAddressSubmenu:Ye.declareString("contact-editor.contactEditorStrings.labelAddAddressSubmenu"),AddWorkSubmenu:Ye.declareString("contact-editor.contactEditorStrings.labelAddWorkSubmenu"),AddOtherSubmenu:Ye.declareString("contact-editor.contactEditorStrings.labelAddOtherSubmenu"),GivenName:Ye.declareString("contact-editor.contactEditorStrings.labelGivenName"),MiddleName:Ye.declareString("contact-editor.contactEditorStrings.labelMiddleName"),Surname:Ye.declareString("contact-editor.contactEditorStrings.labelSurname"),DisplayNamePrefix:Ye.declareString("contact-editor.contactEditorStrings.labelDisplayNamePrefix"),Generation:Ye.declareString("contact-editor.contactEditorStrings.labelGeneration"),Nickname:Ye.declareString("contact-editor.contactEditorStrings.labelNickname"),YomiName:Ye.declareString("contact-editor.contactEditorStrings.labelYomiName"),YomiFirstName:Ye.declareString("contact-editor.contactEditorStrings.labelYomiFirstName"),YomiLastName:Ye.declareString("contact-editor.contactEditorStrings.labelYomiLastName"),PersonaBodies:Ye.declareString("contact-editor.contactEditorStrings.labelPersonaBodies"),PersonaCompanyNames:Ye.declareString("contact-editor.contactEditorStrings.labelCompanyName"),PersonaDepartments:Ye.declareString("contact-editor.contactEditorStrings.labelDepartment"),PersonaOfficeLocations:Ye.declareString("contact-editor.contactEditorStrings.labelLocation"),PersonaTitles:Ye.declareString("contact-editor.contactEditorStrings.labelTitle"),PersonaYomiCompanyNames:Ye.declareString("contact-editor.contactEditorStrings.labelYomiCompanyName"),Email:Ye.declareString("contact-editor.contactEditorStrings.labelEmail"),PersonaAssistantPhoneNumbers:Ye.declareString("contact-editor.contactEditorStrings.labelAssistant"),BusinessPhone:Ye.declareString("contact-editor.contactEditorStrings.labelBusiness"),AddBusiness:Ye.declareString("contact-editor.contactEditorStrings.labelAddBusiness"),PersonaWorkFaxes:Ye.declareString("contact-editor.contactEditorStrings.labelBusinessFax"),PersonaCallbackPhones:Ye.declareString("contact-editor.contactEditorStrings.labelCallback"),HomePhone:Ye.declareString("contact-editor.contactEditorStrings.labelHome"),AddHome:Ye.declareString("contact-editor.contactEditorStrings.labelAddHome"),PersonaHomeFaxes:Ye.declareString("contact-editor.contactEditorStrings.labelHomeFax"),Mobile:Ye.declareString("contact-editor.contactEditorStrings.labelMobile"),AddMobile:Ye.declareString("contact-editor.contactEditorStrings.labelAddMobile"),PersonaOrganizationMainPhones:Ye.declareString("contact-editor.contactEditorStrings.labelOrganizationMain"),Other:Ye.declareString("contact-editor.contactEditorStrings.labelOther"),IM:Ye.declareString("contact-editor.contactEditorStrings.labelIM"),PersonaOtherFaxes:Ye.declareString("contact-editor.contactEditorStrings.labelOtherFax"),PersonaPagers:Ye.declareString("contact-editor.contactEditorStrings.labelPager"),PersonaPhoneNumber:Ye.declareString("contact-editor.contactEditorStrings.labelPrimary"),PersonaRadioPhones:Ye.declareString("contact-editor.contactEditorStrings.labelRadio"),PersonaTelexNumbers:Ye.declareString("contact-editor.contactEditorStrings.labelTelex"),PersonaTTYTDDPhoneNumbers:Ye.declareString("contact-editor.contactEditorStrings.labelTTYTDD"),PersonaManagers:Ye.declareString("contact-editor.contactEditorStrings.labelPersonaManagers"),PersonaBusinessHomePages:Ye.declareString("contact-editor.contactEditorStrings.labelPersonaBusinessHomePages"),PersonaAssistantNames:Ye.declareString("contact-editor.contactEditorStrings.labelPersonaAssistantNames"),PersonaLocations:Ye.declareString("contact-editor.contactEditorStrings.labelPersonaLocations"),PersonaHobbies:Ye.declareString("contact-editor.contactEditorStrings.labelPersonaHobbies"),PersonaSchools:Ye.declareString("contact-editor.contactEditorStrings.labelPersonaSchools"),PersonaHomeAddresses:Ye.declareString("contact-editor.contactEditorStrings.labelPersonaHomeAddresses"),AddPersonaHomeAddresses:Ye.declareString("contact-editor.contactEditorStrings.labelAddPersonaHomeAddresses"),PersonaBusinessAddresses:Ye.declareString("contact-editor.contactEditorStrings.labelPersonaBusinessAddresses"),AddPersonaBusinessAddresses:Ye.declareString("contact-editor.contactEditorStrings.labelAddPersonaBusinessAddresses"),PersonaOtherAddresses:Ye.declareString("contact-editor.contactEditorStrings.labelPersonaOtherAddresses"),AddPersonaOtherAddresses:Ye.declareString("contact-editor.contactEditorStrings.labelAddPersonaOtherAddresses"),Street:Ye.declareString("contact-editor.contactEditorStrings.labelStreet"),City:Ye.declareString("contact-editor.contactEditorStrings.labelCity"),State:Ye.declareString("contact-editor.contactEditorStrings.labelStateProvince"),PostalCode:Ye.declareString("contact-editor.contactEditorStrings.labelZipPostalCode"),Country:Ye.declareString("contact-editor.contactEditorStrings.labelCountryRegion"),PersonaPersonalHomePages:Ye.declareString("contact-editor.contactEditorStrings.labelPersonaPersonalHomePages"),PersonaSpouseNames:Ye.declareString("contact-editor.contactEditorStrings.labelPersonaSpouseNames"),PersonaWeddingAnniversaries:Ye.declareString("contact-editor.contactEditorStrings.labelPersonaWeddingAnniversaries"),PersonaBirthdays:Ye.declareString("contact-editor.contactEditorStrings.labelPersonaBirthdays"),GoToToday:Ye.declareString("contact-editor.contactEditorStrings.labelGoToToday"),GoToPreviousMonth:Ye.declareString("contact-editor.contactEditorStrings.labelGoToPreviousMonth"),GoToNextMonth:Ye.declareString("contact-editor.contactEditorStrings.labelGoToNextMonth"),GoToPrevYear:Ye.declareString("contact-editor.contactEditorStrings.labelGoToPrevYear"),GoToNextYear:Ye.declareString("contact-editor.contactEditorStrings.labelGoToNextYear"),SelectDay:Ye.declareString("contact-editor.contactEditorStrings.labelSelectDay"),Day:Ye.declareString("contact-editor.contactEditorStrings.labelDay"),Month:Ye.declareString("contact-editor.contactEditorStrings.labelMonth"),Year:Ye.declareString("contact-editor.contactEditorStrings.labelYear")},$e=Ke(Ke({},Xe),{PersonaWeddingAnniversariesLocal:Xe.PersonaWeddingAnniversaries,PersonaBirthdaysLocal:Xe.PersonaBirthdays});function Je(e){return $e[e]()}function qe(e){switch(e){case"PersonaHomePhones":case"PersonaHomePhones2":return Je("HomePhone");case"PersonaBusinessPhoneNumbers":case"PersonaBusinessPhoneNumbers2":return Je("BusinessPhone");case"PersonaMobilePhones":case"PersonaCarPhones":return Je("Mobile");case"PersonaOtherTelephones":case"PersonaOtherPhones2":return Je("Other");default:return Je(e)}}function Qe(e){switch(e){case"PersonaHomePhones":case"PersonaHomePhones2":return Je("AddHome");case"PersonaBusinessPhoneNumbers":case"PersonaBusinessPhoneNumbers2":return Je("AddBusiness");case"PersonaMobilePhones":case"PersonaCarPhones":return Je("AddMobile");case"PersonaOtherTelephones":case"PersonaOtherPhones2":return Je("Other");default:return Je(e)}}function Ze(e){switch(e){case"PersonaHomeAddresses":return Je("AddPersonaHomeAddresses");case"PersonaBusinessAddresses":return Je("AddPersonaBusinessAddresses");case"PersonaOtherAddresses":return Je("AddPersonaOtherAddresses");default:return Object(o.a)(e)}}var et=function(){return(et=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},tt=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},rt={updatedNames:{},updatedPhones:[],updatedWorkDetails:[],updatedIms:[],updatedPostalAddresses:[],updatedEmails:[],updatedOtherContactProps:[],updatedPersonalNotes:[],updatedProfilePhoto:null,validationErrors:!1},nt={index:0,oldValue:null,newValue:"",attributions:[],isWritable:!0},ot=et(et({},nt),{propertyUri:"PersonaCompanyNames"}),at={updatedNames:{PersonaGivenNames:{oldValue:null,newValue:""},PersonaSurnames:{oldValue:null,newValue:""}},updatedPhones:[et(et({},nt),{propertyUri:"PersonaMobilePhones"})],updatedWorkDetails:[ot],updatedIms:[],updatedPostalAddresses:[],updatedEmails:[et(et({},nt),{propertyUri:"PersonaEmails1",oldDisplayNameValue:null,oldOriginalDisplayNameValue:null})],updatedOtherContactProps:[],updatedPersonalNotes:[],updatedProfilePhoto:null,validationErrors:!1};function it(e,t,r){return 0===Xt(e,t).length&&(null===e.updatedProfilePhoto||"NewContact"===r)}function st(e){switch(e){case"DisplayNamePrefix":return"PersonaDisplayNamePrefixes";case"Generation":return"PersonaGenerations";case"GivenName":return"PersonaGivenNames";case"MiddleName":return"PersonaMiddleNames";case"Nickname":return"PersonaNicknames";case"Surname":return"PersonaSurnames";case"YomiFirstName":return"PersonaYomiFirstNames";case"YomiLastName":return"PersonaYomiLastNames";case"YomiName":return"PersonaYomiFirstNames";default:return Object(o.a)(e)}}function ct(e,t,r){var n=Object(b.a)(e,(function(e){return r(e,t)}));if(-1===n)return e.concat(t);var o=e.slice();return o.splice(n,1,t),o}function lt(e,t){return e.propertyUri===t.propertyUri&&e.index===t.index}function ut(e,t){return e.propertyUri===t.propertyUri&&(e.index===t.index||""===e.newValue)}function dt(e,t){return et(et({},nt),{propertyUri:e,newValue:t,index:-1})}function pt(e,t){for(var r=e,n=0,o=t;n<o.length;n++){r=ct(r,o[n],lt)}return r}function mt(e){switch(e){case"YomiFirstName":case"YomiLastName":return"YomiName";default:return e}}function ft(e,t,r,n){var o,a=st(t);return a?Object(ie.j)(e,{updatedNames:Object(ie.j)(e.updatedNames,(o={},o[a]={oldValue:r,newValue:n},o))}):e}function ht(e){var t,r=(t=e.AttributionsArray,function(e,r){return Dt((e||[]).map((function(e,n){if(e.Value&&e.Value.Type){var o=ur(t,e.Attributions);return{propertyUri:r,index:n,oldValue:Object(ie.i)(e.Value&&e.Value.Number),newValue:e.Value&&e.Value.Number||"",isWritable:o,attributions:ze(e.Attributions,t)}}return console.error("Got phone entry without type (".concat(r,")")),null})))});return r(e.AssistantPhoneNumbersArray,"PersonaAssistantPhoneNumbers").concat(r(e.BusinessPhoneNumbersArray,"PersonaBusinessPhoneNumbers")).concat(r(e.BusinessPhoneNumbers2Array,"PersonaBusinessPhoneNumbers2")).concat(r(e.CallbackPhonesArray,"PersonaCallbackPhones")).concat(r(e.CarPhonesArray,"PersonaCarPhones")).concat(r(e.HomeFaxesArray,"PersonaHomeFaxes")).concat(r(e.HomePhonesArray,"PersonaHomePhones")).concat(r(e.HomePhones2Array,"PersonaHomePhones2")).concat(r(e.MobilePhonesArray,"PersonaMobilePhones")).concat(r(e.OrganizationMainPhonesArray,"PersonaOrganizationMainPhones")).concat(r(e.OtherFaxesArray,"PersonaOtherFaxes")).concat(r(e.OtherTelephonesArray,"PersonaOtherTelephones")).concat(r(e.OtherPhones2Array,"PersonaOtherPhones2")).concat(r(e.PagersArray,"PersonaPagers")).concat(r(e.RadioPhonesArray,"PersonaRadioPhones")).concat(r(e.TelexNumbersArray,"PersonaTelexNumbers")).concat(r(e.TTYTDDPhoneNumbersArray,"PersonaTTYTDDPhoneNumbers")).concat(r(e.WorkFaxesArray,"PersonaWorkFaxes"))}function gt(e,t){return pt(ht(e),t.updatedPhones)}function bt(e,t,r,n,o){var a=r(e,t).filter((function(e){return!0===e.isWritable})),i=n.filter((function(e){return!a.some((function(t){return t.propertyUri===e}))}));return o?i:i.filter((function(e){return!function(e){switch(e){case"PersonaOfficeLocations":case"PersonaDepartments":case"PersonaManagers":case"PersonaAssistantNames":case"PersonaBusinessHomePages":case"PersonaSchools":case"PersonaLocations":case"PersonaHobbies":return!0;default:return!1}}(e)}))}function yt(e,t,r){var n=dt(t,r||""),o=ct(e.updatedPhones,n,ut);return Object(ie.j)(e,{updatedPhones:o})}function Pt(e,t){var r=ct(e.updatedPhones,t,lt);return Object(ie.j)(e,{updatedPhones:r})}function St(e,t){return pt(Nt(e),t.updatedIms)}function Et(e,t){var r=dt("PersonaImAddresses",t||""),n=ct(e.updatedIms,r,ut);return Object(ie.j)(e,{updatedIms:n})}function vt(e,t){var r=ct(e.updatedIms,t,lt);return Object(ie.j)(e,{updatedIms:r})}function xt(e,t,r){var n=ct(e.updatedPostalAddresses,dt(t,r||{Street:"",City:"",Country:"",PostalCode:"",State:""}),ut);return Object(ie.j)(e,{updatedPostalAddresses:n})}function At(e,t){var r=ct(e.updatedPostalAddresses,t,lt);return Object(ie.j)(e,{updatedPostalAddresses:r})}function Nt(e){return function(e,t){var r=e.AttributionsArray;return Dt((e.ImAddressesArray||[]).map((function(e,n){var o=ur(r,e.Attributions),a=e.Value?e.Value.replace(/^sip:/,""):e.Value;return{propertyUri:t,attributions:ze(e.Attributions,r),index:n,oldValue:Object(ie.i)(a),newValue:a||"",isWritable:o}})))}(e,"PersonaImAddresses")}function Ot(e){return Ut(e.Emails1Array,e.AttributionsArray,"PersonaEmails1").concat(Ut(e.Emails2Array,e.AttributionsArray,"PersonaEmails2")).concat(Ut(e.Emails3Array,e.AttributionsArray,"PersonaEmails3"))}function Ct(e){var t,r=Ot(e);return t=r,Object(me.a)(t,(function(e,t){var r;return e.newValue===t.newValue&&e.isWritable===t.isWritable&&!!(r=t.attributions).push.apply(r,Object(pe.a)(e.attributions,t.attributions))}))}function wt(e,t){return pt(Ot(e),t.updatedEmails)}function kt(e,t,r){var n=et(et({},dt(t,r||"")),{oldDisplayNameValue:null,oldOriginalDisplayNameValue:null}),o=ct(e.updatedEmails,n,ut);return Object(ie.j)(e,{updatedEmails:o})}function jt(e,t){var r=t;t.newValue&&he()(t.newValue.trim())&&(r=et(et({},t),{showErrorMessage:!1}));var n=ct(e.updatedEmails,r,lt);return Object(ie.j)(e,{updatedEmails:n})}function Vt(e){return"RecipientCache"!==e}function Dt(e){return Object(se.filterOutNull)(e).reduce((function(e,t){var r=t&&t.attributions.filter(Vt);return(t&&!t.attributions.length||r&&r.length>0)&&e.push(Object(ie.j)(t,{attributions:r})),e}),[])}function Ut(e,t,r){return Dt((e||[]).map((function(e,n){if(!e.Value)return null;var o="EX"!==e.Value.RoutingType&&e.Value.EmailAddress?e.Value.EmailAddress:e.Value.OriginalDisplayName;if(!o)return null;var a=ur(t||[],e.Attributions);return{propertyUri:r,index:n,oldValue:Object(ie.i)(e.Value.EmailAddress),newValue:o,oldDisplayNameValue:Object(ie.i)(e.Value.Name),oldOriginalDisplayNameValue:Object(ie.i)(e.Value.OriginalDisplayName),attributions:ze(e.Attributions,t),isWritable:a}})))}function Tt(e,t){return pt(Kt(e),t.updatedPostalAddresses)}function Lt(e,t,r){return Dt((e||[]).map((function(e,n){if(e.Value&&e.Value.Type){var o=ur(t||[],e.Attributions);return{propertyUri:r,index:n,oldValue:e.Value,newValue:e.Value,editing:!1,attributions:ze(e.Attributions,t),isWritable:o}}return null})))}function Bt(e,t,r){return Dt((e||[]).map((function(e,n){if(e.Value){var o="string"==typeof e.Value?new Date(e.Value):e.Value,a=ur(t||[],e.Attributions);return{propertyUri:r,index:n,oldValue:o,newValue:o,attributions:ze(e.Attributions,t),isWritable:a,isRemoved:!1}}return null})))}function Mt(e,t,r){return Dt((e||[]).map((function(e,n){return e.Value&&"string"==typeof e.Value?{propertyUri:r,index:n,oldValue:e.Value,newValue:e.Value,attributions:ze(e.Attributions,t),isWritable:ur(t||[],e.Attributions)}:null})))}function Wt(e,t,r,n){var o=Bt(t,r,n).concat(Bt(e,r,n)).pop();return o?[o]:[]}function Rt(e){return Wt(e.WeddingAnniversariesLocalArray,e.WeddingAnniversariesArray,e.AttributionsArray,"PersonaWeddingAnniversaries").concat(Wt(e.BirthdaysLocalArray,e.BirthdaysArray,e.AttributionsArray,"PersonaBirthdays")).concat(Mt(e.PersonalHomePagesArray,e.AttributionsArray,"PersonaPersonalHomePages")).concat(Mt(e.SpouseNamesArray,e.AttributionsArray,"PersonaSpouseNames")).concat(Mt(e.ManagersArray,e.AttributionsArray,"PersonaManagers")).concat(Mt(e.AssistantNamesArray,e.AttributionsArray,"PersonaAssistantNames")).concat(Mt(e.BusinessHomePagesArray,e.AttributionsArray,"PersonaBusinessHomePages")).concat(Mt(e.SchoolsArray,e.AttributionsArray,"PersonaSchools")).concat(Mt(e.LocationsArray,e.AttributionsArray,"PersonaLocations")).concat(Mt(e.HobbiesArray,e.AttributionsArray,"PersonaHobbies"))}function It(e,t){return pt(Rt(e),t.updatedOtherContactProps).filter((function(e){return gr(e)&&!e.isRemoved||!gr(e)}))}function Ft(e,t,r){var n=e.updatedOtherContactProps,o=e.updatedOtherContactProps.filter(gr),a=Object(de.a)(o,(function(e){return!!e.isRemoved&&e.propertyUri===t}));a&&-1!==a.index?n=e.updatedOtherContactProps.filter((function(e){return e!==a})):n=function(e,t,r){var n=Object(b.a)(e,(function(e){return r(e,t)}));if(-1===n)return e.concat(t);var o=e.slice();return o.splice(n,1),o.concat(t)}(n,He(t)?et(et({},dt(t,r?new Date(r):null)),{isRemoved:!1}):dt(t,r||""),ut);return Object(ie.j)(e,{updatedOtherContactProps:n})}function Ht(e,t){var r=ct(e.updatedOtherContactProps,t,lt);return Object(ie.j)(e,{updatedOtherContactProps:r})}function Yt(e,t){var r=dt("PersonaBodies",t||""),n=ct(e.updatedPersonalNotes,r,ut);return Object(ie.j)(e,{updatedPersonalNotes:n})}function _t(e,t){var r=ct(e.updatedPersonalNotes,t,lt);return Object(ie.j)(e,{updatedPersonalNotes:r})}function Gt(e){return e.BodiesArray?Object(se.filterOutNull)(e.BodiesArray).map((function(t,r){return{propertyUri:"PersonaBodies",index:r,oldValue:Object(ie.i)(t.Value&&t.Value.Value),newValue:t.Value&&t.Value.Value||"",attributions:ze(t.Attributions,e.AttributionsArray),isWritable:ur(e.AttributionsArray,t.Attributions)}})):[{propertyUri:"PersonaBodies",index:0,oldValue:"",newValue:"",attributions:[],isWritable:!0}]}function zt(e,t){return pt(Gt(e),t.updatedPersonalNotes)}function Kt(e){return Lt(e.BusinessAddressesArray,e.AttributionsArray,"PersonaBusinessAddresses").concat(Lt(e.HomeAddressesArray,e.AttributionsArray,"PersonaHomeAddresses")).concat(Lt(e.OtherAddressesArray,e.AttributionsArray,"PersonaOtherAddresses"))}function Xt(e,t){var r=t?et(et({},e),{updatedEmails:hr(e.updatedEmails,t)}):e,n=function(e,t){if(!t)return Object(ce.keys)(e.updatedNames).map((function(t){var r=e.updatedNames[t];return{propertyUri:t,oldValue:"",newValue:r&&r.newValue||""}}));if(0===Object(ce.keys)(e.updatedNames).length)return[];for(var r=(t.AttributionsArray||[]).filter((function(e){return e.IsWritable})).map((function(e){return e.Id})),n=[],o=0,a=be;o<a.length;o++){for(var i=a[o],s=st(i),c=pr(t,s).filter((function(e){return!e.Attributions||e.Attributions.some((function(e){return!!e&&r.indexOf(e)>=0}))})),l=e.updatedNames[s],u=l?l.newValue||"":t[i]||"",d=[],p=0,m=c;p<m.length;p++){var f=m[p];n.push({propertyUri:s,oldValue:f.Value||"",newValue:u}),d.push.apply(d,f.Attributions||[])}for(var h=Object(pe.a)(r,d).length,g=0;g<h;g++)n.push({propertyUri:s,oldValue:"",newValue:u})}return n.filter((function(e){return e.newValue!==e.oldValue}))}(r,t),o=function(e){return e.updatedPostalAddresses.map((function(e){var t=[e.oldValue&&e.oldValue.Street||"",e.oldValue&&e.oldValue.City||"",e.oldValue&&e.oldValue.State||"",e.oldValue&&e.oldValue.PostalCode||"",e.oldValue&&e.oldValue.Country||""].join("$#$"),r=[e&&e.newValue&&e.newValue.Street||"",e&&e.newValue&&e.newValue.City||"",e&&e.newValue&&e.newValue.State||"",e&&e.newValue&&e.newValue.PostalCode||"",e&&e.newValue&&e.newValue.Country||""].join("$#$");return{propertyUri:e.propertyUri,oldValue:t,newValue:r}})).filter((function(e){return e.oldValue!==e.newValue}))}(r),a=function(e,t){return Jt(e,t&&t.BirthdaysArray||[],"PersonaBirthdays",t&&t.BirthdaysLocalArray||[],"PersonaBirthdaysLocal").concat(Jt(e,t&&t.WeddingAnniversariesArray||[],"PersonaWeddingAnniversaries",t&&t.WeddingAnniversariesLocalArray||[],"PersonaWeddingAnniversariesLocal")).concat(e.updatedOtherContactProps.filter((function(e){return!gr(e)})).map((function(e){var t="string"==typeof e.oldValue?e.oldValue:"",r="string"==typeof e.newValue?e.newValue:"";return{propertyUri:e.propertyUri,oldValue:t,newValue:r}})))}(r,t),i=function(e){return e.updatedPersonalNotes.map((function(e){return{propertyUri:e.propertyUri,oldValue:e.oldValue?e.oldValue:"",newValue:e.newValue||""}}))}(r),s=function(e,t){return qt(e,t||null,Qt,er,rr)}(r,t),c=function(e,t){return qt(e,t||null,Zt,tr,nr)}(r,t);return tt(tt(tt(tt(tt(tt(tt(tt(tt(tt([],n,!0),r.updatedEmails,!0),s,!0),c,!0),r.updatedIms,!0),r.updatedPhones,!0),r.updatedWorkDetails,!0),o,!0),a,!0),i,!0).map((function(e){return{propertyUri:e.propertyUri,oldValue:e.oldValue||"",newValue:e.newValue&&e.newValue.trim()||""}})).filter((function(e){return""!==e.oldValue||""!==e.newValue})).filter((function(e){return e.oldValue!==e.newValue}))}function $t(e,t,r){return 0===e.length?[{propertyUri:t,oldValue:"",newValue:r}]:e.map((function(e){return{propertyUri:t,oldValue:e.Value||"",newValue:r}}))}function Jt(e,t,r,n,o){var a=e.updatedOtherContactProps.filter((function(e){return e.propertyUri===r||e.propertyUri===o}))[0];if(!a)return[];var i=a.newValue?"string"==typeof a.newValue?a.newValue:a.newValue.toISOString():"";return $t(t,r,i).concat($t(n,o,i))}function qt(e,t,r,n,a){return e.updatedEmails.map((function(e){var i=e.newValue||"",s=r(e);if(-1===e.index&&t)switch(e.propertyUri){case"PersonaEmails1":s=n(t.Emails1Array||[]);break;case"PersonaEmails2":s=n(t.Emails2Array||[]);break;case"PersonaEmails3":s=n(t.Emails3Array||[]);break;default:return Object(o.a)(e.propertyUri)}return{propertyUri:a(e.propertyUri),oldValue:s,newValue:i}}))}function Qt(e){return e.oldDisplayNameValue||""}function Zt(e){return e.oldOriginalDisplayNameValue||""}function er(e){var t=Object(de.a)(e,(function(e){return!!e.Value&&!!e.Value.Name}));return t&&t.Value&&t.Value.Name?t.Value.Name:""}function tr(e){var t=Object(de.a)(e,(function(e){return!!e.Value&&!!e.Value.OriginalDisplayName}));return t&&t.Value&&t.Value.OriginalDisplayName?t.Value.OriginalDisplayName:""}function rr(e){switch(e){case"PersonaEmails1":return"PersonaEmails1DisplayNames";case"PersonaEmails2":return"PersonaEmails2DisplayNames";case"PersonaEmails3":return"PersonaEmails3DisplayNames";default:return Object(o.a)(e)}}function nr(e){switch(e){case"PersonaEmails1":return"PersonaEmails1OriginalDisplayNames";case"PersonaEmails2":return"PersonaEmails2OriginalDisplayNames";case"PersonaEmails3":return"PersonaEmails3OriginalDisplayNames";default:return Object(o.a)(e)}}function or(e,t,r){var n=dt(t,r||""),o=ct(e.updatedWorkDetails,n,ut);return Object(ie.j)(e,{updatedWorkDetails:o})}function ar(e,t){var r=ct(e.updatedWorkDetails,t,lt);return Object(ie.j)(e,{updatedWorkDetails:r})}function ir(e,t){return pt(sr(e),t.updatedWorkDetails)}function sr(e){return cr(e.CompanyNamesArray,e.AttributionsArray,"PersonaCompanyNames").concat(cr(e.TitlesArray,e.AttributionsArray,"PersonaTitles")).concat(cr(e.DepartmentsArray,e.AttributionsArray,"PersonaDepartments")).concat(cr(e.OfficeLocationsArray,e.AttributionsArray,"PersonaOfficeLocations")).concat(cr(e.YomiCompanyNamesArray,e.AttributionsArray,"PersonaYomiCompanyNames"))}function cr(e,t,r){return Dt((e||[]).map((function(e,n){return{propertyUri:r,index:n,oldValue:Object(ie.i)(e.Value),newValue:e.Value||"",attributions:ze(e.Attributions,t),isWritable:ur(t||[],e.Attributions)}})))}function lr(e,t){var r={},n=["GivenName","Surname"];return(e.YomiFirstName||e.YomiLastName)&&n.push("YomiFirstName","YomiLastName"),be.forEach((function(o){var a,i,s,c=st(o),l=e[o],u=t.updatedNames[c],d=u&&u.newValue,p=ze(function(e,t){return e.filter((function(e){return e.Value===t})).reduce((function(e,t){return e.concat(t.Attributions||[])}),[])}(pr(e,o),l),e.AttributionsArray).filter(Vt);void 0!==d?r=et(et({},r),((a={})[o]={propertyUri:c,oldValue:l,newValue:d,attributions:p,isWritable:!0},a)):l?r=et(et({},r),((i={})[o]={propertyUri:c,oldValue:l,newValue:l,attributions:p,isWritable:!0},i)):-1!==n.indexOf(o)&&(r=et(et({},r),((s={})[o]={propertyUri:c,oldValue:null,newValue:"",isWritable:!0,attributions:p},s)))})),r}function ur(e,t){return!(!e||!t)&&t.some((function(t){return e.some((function(e){return e.Id===t&&!0===e.IsWritable}))}))}function dr(e){return e?[{Value:e,Attributions:null}]:[]}function pr(e,t){switch(t){case"DisplayNamePrefix":case"PersonaDisplayNamePrefixes":return e.DisplayNamePrefixesArray||dr(e.DisplayNamePrefix);case"GivenName":case"PersonaGivenNames":return e.GivenNamesArray||dr(e.GivenName);case"MiddleName":case"PersonaMiddleNames":return e.MiddleNamesArray||dr(e.MiddleName);case"Surname":case"PersonaSurnames":return e.SurnamesArray||dr(e.Surname);case"Generation":case"PersonaGenerations":return e.GenerationsArray||dr(e.Generation);case"Nickname":case"PersonaNicknames":return e.NicknamesArray||dr(e.Nickname);case"YomiFirstName":case"PersonaYomiFirstNames":return e.YomiFirstNamesArray||dr(e.YomiFirstName);case"YomiLastName":case"PersonaYomiLastNames":return e.YomiLastNamesArray||dr(e.YomiLastName);default:return Object(o.a)(t)}}function mr(e){for(var t=0,r=be;t<r.length;t++){var n=r[t],o=e.updatedNames[st(n)];if(o&&o.newValue.length>255)return st(n)}var a=function(e){return e.newValue.length>255},i=Object(de.a)(e.updatedEmails,(function(e){return a(e)||!!e.showErrorMessage}))||Object(de.a)(e.updatedIms,a)||Object(de.a)(e.updatedPhones,a)||Object(de.a)(e.updatedWorkDetails,a)||Object(de.a)(e.updatedPostalAddresses,(function(e){return e.newValue.Street&&e.newValue.Street.length>255||e.newValue.City&&e.newValue.City.length>255||e.newValue.Country&&e.newValue.Country.length>255||e.newValue.PostalCode&&e.newValue.PostalCode.length>255||e.newValue.State&&e.newValue.State.length>255||!1}))||Object(de.a)(e.updatedOtherContactProps,(function(e){return!gr(e)&&a(e)}));return i?i.propertyUri:""}function fr(e){return e.some((function(e){return!e.isWritable}))}function hr(e,t){var r=Ot(t),n=[];return r.map((function(t){return r.map((function(r){t!==r&&t.newValue===r.newValue&&t.isWritable===r.isWritable&&e.map((function(e){return e.propertyUri===r.propertyUri&&e.index===r.index&&n.push(et(et({},t),{newValue:e.newValue}))}))}))})),n.push.apply(n,e),n}function gr(e){return He(e.propertyUri)}var br=r(48),yr=r(989),Pr=r(47),Sr=r(145),Er=r(69),vr=function(){return(vr=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},xr=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},Ar="idle",Nr=null,Or=rt,Cr="",wr=null,kr={idle:[{action:v,nextState:"loading"},{action:x,nextState:"editing"}],loading:[{action:A,nextState:"editing"},{action:N,nextState:"loadErrorDialogOpen"}],editing:[{action:z,nextState:"saving"},{action:K,nextState:"editing"},{action:Q,nextState:"discardDialogOpen"},{action:te,nextState:"idle"}],saving:[{action:ee,nextState:"idle"},{action:re,nextState:"failed"}],discardDialogOpen:[{action:$,nextState:"idle"},{action:q,nextState:"editing"},{action:te,nextState:"idle"}],loadErrorDialogOpen:[{action:J,nextState:"loading"},{action:q,nextState:"idle"}],failed:[{action:z,nextState:"idle"},{action:te,nextState:"idle"}]},jr=Object(br.a)().handleAction(x,(function(e,t){var r=xr([],t.payload.initialValues,!0),n=t.payload.focusPropertyUri;n&&Fe(n)&&-1===t.payload.initialValues.map((function(e){return e.propertyUri})).indexOf(n)&&(r=We(n)?xr(xr([],r,!0),[{propertyUri:n,value:{Street:"",City:"",Country:"",PostalCode:"",State:""}}],!1):xr(xr([],r,!0),[{propertyUri:n,value:""}],!1));return t.payload.initialValues.reduce(Br,at)})).handleAction(O,(function(e,t){var r=Or,n=t.payload.originalContact,o=lr(n,r),a=!1;Object(ce.keys)(o).forEach((function(e){var t=o&&o[e],n=t&&t.newValue||"";Object(Sr.d)(n)||(a=!0),r=ft(r,e,"",n)})),!1===a&&(r=ft(r,"GivenName","",n.DisplayName||""));0===(r=Wr(Ct,jt,n,r)).updatedEmails.length&&n.EmailAddress&&n.EmailAddress.EmailAddress&&(r=Wr(Mr,jt,n,r));return r=Wr(ht,Pt,n,r),r=Wr(sr,ar,n,r),r=Wr(Kt,At,n,r),r=Wr(Rt,Ht,n,r),r=Wr(Gt,_t,n,r),r=Wr(Nt,vt,n,r)})).handleAction(A,(function(e,t){var r=t.payload,n=r.focusPropertyUri,o=r.originalContact;if(!n||!Fe(n)||!o)return e;if(De(n)||(Ue(n)?Ot(o).some((function(e){return e.isWritable})):Te(n)?Nt(o).some((function(e){return e.isWritable})):Le(n)||Be(n)?ht(o).some((function(e){return e.isWritable&&e.propertyUri===n})):Re(n)?Rt(o).some((function(e){return e.isWritable&&e.propertyUri===n})):Ie(n)?Gt(o).some((function(e){return e.isWritable})):Me(n)?sr(o).some((function(e){return e.isWritable&&e.propertyUri===n})):We(n)?Kt(o).some((function(e){return e.isWritable&&e.propertyUri===n})):void 0))return e;var a=We(n)?{propertyUri:n,value:{Street:"",City:"",Country:"",PostalCode:"",State:""}}:{propertyUri:n,value:""};return Br(e,a)})).handleAction(C,(function(e,t){return function(e,t){for(var r,n=0,o="YomiName"===t?["YomiFirstName","YomiLastName"]:[t];n<o.length;n++){var a=st(o[n]),i=e.updatedNames[a];if(i&&(i.oldValue||i.newValue));else{var s=Object(ie.j)(e.updatedNames,((r={})[a]={oldValue:null,newValue:""},r));e=Object(ie.j)(e,{updatedNames:s})}}return e}(e,t.payload.availableName)})).handleAction(w,(function(e,t){var r=t.payload;return ft(e,r.fieldType,r.oldValue,r.newValue)})).handleAction(k,(function(e,t){return yt(e,t.payload.availablePhone)})).handleAction(j,(function(e,t){return Pt(e,t.payload.phone)})).handleAction(D,(function(e,t){return xt(e,t.payload.availablePostalAddress)})).handleAction(U,(function(e,t){return At(e,t.payload.postalAddress)})).handleAction(T,(function(e,t){return Ft(e,t.payload.availableOtherContactProp)})).handleAction(L,(function(e,t){return Ht(e,t.payload.otherContactProp)})).handleAction(B,(function(e,t){return function(e,t){var r=et(et({},t),{isRemoved:!0,newValue:null}),n=ct(e.updatedOtherContactProps,r,lt);return Object(ie.j)(e,{updatedOtherContactProps:n})}(e,t.payload.otherContactDateProp)})).handleAction(M,(function(e){return Et(e)})).handleAction(W,(function(e,t){return vt(e,t.payload.im)})).handleAction(R,(function(e,t){return kt(e,t.payload.availableEmail)})).handleAction(I,(function(e,t){return function(e,t){var r=et(et({},t),{showErrorMessage:!(!t.newValue||he()(t.newValue.trim()))}),n=ct(e.updatedEmails,r,lt);return Object(ie.j)(e,{updatedEmails:n})}(e,t.payload.email)})).handleAction(F,(function(e,t){return jt(e,t.payload.email)})).handleAction(_,(function(e,t){return or(e,t.payload.availableWorkDetail)})).handleAction(G,(function(e,t){return ar(e,t.payload.workDetail)})).handleAction(H,(function(e){return Yt(e)})).handleAction(Y,(function(e,t){return _t(e,t.payload.note)})).handleAction(oe,(function(e,t){return function(e,t){return Object(ie.j)(e,{updatedProfilePhoto:t})}(e,t.payload.dataUri)})).handleAction(ee,(function(){return Or})).handleAction(te,(function(){return Or})).handleAction(z,(function(e){return vr(vr({},e),{validationErrors:!1})})).handleAction(K,(function(e){return vr(vr({},e),{validationErrors:!0})})).done(rt),Vr=Object(br.a)().handleAction(x,(function(e,t){return t.payload.focusPropertyUri||"PersonaGivenNames"})).handleAction(v,(function(e,t){return t.payload.focusPropertyUri||"PersonaGivenNames"})).handleAction(C,(function(e,t){return st(t.payload.availableName)})).handleAction(k,(function(e,t){return t.payload.availablePhone})).handleAction(D,(function(e,t){return t.payload.availablePostalAddress})).handleAction(V,(function(e,t){return t.payload.postalAddress.propertyUri})).handleAction(T,(function(e,t){return t.payload.availableOtherContactProp})).handleAction(R,(function(e,t){return t.payload.availableEmail})).handleAction(M,(function(e,t){return t.payload.availableIm})).handleAction(_,(function(e,t){return t.payload.availableWorkDetail})).handleAction(H,(function(){return"PersonaBodies"})).handleAction(ee,(function(){return Cr})).handleAction(te,(function(){return Cr})).done(Cr),Dr=Object(br.a)().handleAction(x,(function(){return Nr})).handleAction(A,(function(e,t){return t.payload.originalContact})).handleAction(ee,(function(){return Nr})).handleAction(te,(function(){return Nr})).done(Nr),Ur=Object(br.a)().handleAction(ae,(function(e,t){return null})).handleAction(z,(function(){return wr})).handleAction(K,(function(e,t){return t.payload})).handleAction(re,(function(e,t){return{message:t.payload.error,propertyUri:""}})).handleAction(ee,(function(){return wr})).handleAction(te,(function(){return wr})).done(wr),Tr=Object(Er.combineReducers)({editorState:Object(yr.a)(kr,Ar),originalContact:Dr,changeSet:jr,mostRecentPropertyUri:Vr,errorState:Ur}),Lr=Object(Pr.a)("ContactEditorStore",Tr,(function(e){return{editorState:e.editorState,originalContact:e.originalContact,changeSet:e.changeSet,errorState:e.errorState,mostRecentPropertyUri:e.mostRecentPropertyUri,phones:gt(e.originalContact||{},e.changeSet),updatedValues:Xt(e.changeSet,e.originalContact||void 0)}})),Br=function(e,t){var r;if(function(e){return!je(e)}(t)){if(De(t.propertyUri))return Object(ie.j)(e,{updatedNames:Object(ie.j)(e.updatedNames,(r={},r[t.propertyUri]={oldValue:null,newValue:t.value},r))});if(Ue(t.propertyUri))return kt(e,t.propertyUri,t.value);if(Te(t.propertyUri))return Et(e,t.value);if(Le(t.propertyUri)||Be(t.propertyUri))return yt(e,t.propertyUri,t.value);if(Re(t.propertyUri))return Ft(e,t.propertyUri,t.value);if(Ie(t.propertyUri))return Yt(e,t.value);if(Me(t.propertyUri))return or(e,t.propertyUri,t.value)}else if(je(t))return xt(e,t.propertyUri,t.value);return e};function Mr(e){return[{propertyUri:"PersonaEmails1",index:-1,oldValue:null,newValue:e.EmailAddress&&e.EmailAddress.EmailAddress||"",oldDisplayNameValue:null,oldOriginalDisplayNameValue:null,attributions:[],isWritable:!0}]}function Wr(e,t,r,n){return e(r).map((function(e){return n=t(n,Object(ie.j)(e,{oldValue:"",isWritable:!0}))})),n}var Rr=r(14),Ir=r(119),Fr=function(){return(Fr=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Hr(e,t){return e?t:void 0}var Yr=Object(Ir.c)((function(e,t,r){return Object(Rr.db)({row:[{display:"flex",flexDirection:"row",flexShrink:"0",selectors:{"& > div + div":{marginLeft:r},"& > div":Fr(Fr({},Hr(e,{marginLeft:r,marginTop:r})),Hr(t,{flex:1}))}},e&&{flexWrap:"wrap",marginTop:"-".concat(r),marginLeft:"-".concat(r)}]})}));function _r(e){var t=Yr(e.wrap,e.equalWidthChildren,"24px").row;return y.createElement("div",{className:"".concat(t," ").concat(e.className||"")},e.children)}var Gr=Object(Ir.c)((function(e){return Object(Rr.db)({column:{display:"flex",flexDirection:"column"}})}));function zr(e){var t=Gr("24px").column;return y.createElement("div",{className:"".concat(t," ").concat(e.className||"")},e.children)}var Kr=Object(Ir.c)((function(e){var t=e.palette.neutralLighter;return Object(Rr.db)({persona:{minWidth:"100px",height:"100px",borderRadius:"50%",backgroundColor:t},nameblock:{marginTop:"4px"},section:{backgroundColor:t,height:"19px",minWidth:"133px",marginBottom:"17px",marginTop:"16px"},label:{backgroundColor:t,height:"12px",minWidth:"100px",marginBottom:"4px"},namefield:{backgroundColor:t,height:"19px",minWidth:"156px",marginBottom:"17px"},textfield:{backgroundColor:t,height:"19px",minWidth:"194px",marginBottom:"17px"},notes:{height:"56px",minWidth:"404px",borderWidth:"1px",borderColor:t,borderStyle:"solid",marginBottom:"56px"}})}));function Xr(e){var t=Kr(e.theme);return y.createElement("div",{className:e.styling},y.createElement(_r,null,y.createElement(zr,null,y.createElement("div",{className:t.persona})),y.createElement(zr,null,y.createElement("div",{className:t.nameblock},y.createElement(_r,null,y.createElement("div",{className:t.label})),y.createElement(_r,null,y.createElement("div",{className:t.namefield})),y.createElement(_r,null,y.createElement("div",{className:t.label})),y.createElement(_r,null,y.createElement("div",{className:t.namefield}))))),y.createElement(_r,null,y.createElement("div",{className:t.section})),y.createElement(_r,null,y.createElement("div",{className:t.label})),y.createElement(_r,null,y.createElement("div",{className:t.textfield})),y.createElement(_r,null,y.createElement("div",{className:t.label})),y.createElement(_r,null,y.createElement("div",{className:t.textfield})),y.createElement(_r,null,y.createElement("div",{className:t.label})),y.createElement(_r,null,y.createElement("div",{className:t.textfield})),y.createElement(_r,null,y.createElement("div",{className:t.label})),y.createElement(_r,null,y.createElement("div",{className:t.textfield})),y.createElement(_r,null,y.createElement("div",{className:t.section})),y.createElement(_r,null,y.createElement("div",{className:t.notes})))}var $r=Object(Ir.c)((function(){var e={sectionTitle:Object(Rr.Y)().fonts.large};return Object(Rr.db)(e,{sectionBlock:{border:0,padding:0,marginTop:"24px"},sectionTitle:{fontWeight:600,padding:0}})}));function Jr(e){var t=$r();return y.createElement("fieldset",{className:t.sectionBlock},y.createElement("legend",{role:"heading","aria-level":2,className:t.sectionTitle},e.header),e.children)}var qr,Qr=r(1215),Zr=r(82),en=Ye.declareString("contact-editor.contactEditorStrings.attributionsAriaLabel"),tn=Ye.declareString("contact-editor.contactEditorStrings.attributionsCaption"),rn=Object(Ir.c)((function(e){return Object(Rr.db)({attributionInfoIcon:{selectors:{".ms-Button":{verticalAlign:"middle",width:"16px",height:"16px",boxSizing:"content-box"},".ms-Button-icon":{fontSize:"13px",color:e.palette.themePrimary}}},attributionHover:{visibility:"hidden",selectors:{"*:hover > * > * > &":{visibility:"visible"},"*:focus":{visibility:"visible"},".ms-Fabric.is-focusVisible &":{visibility:"visible"}}},attributionCallout:{selectors:{".ms-Callout-main":{padding:"14px",overflow:"visible !important"}}},calloutContent:{margin:"-24px",padding:"24px",fontSize:"12px"},attributionTitle:{fontWeight:"bold"}})})),nn=(qr=function(e,t){return(qr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}qr(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),on=function(e){function t(t){var r=e.call(this,t)||this;return r.iconButtonElement=null,r.onClickIcon=function(e){e&&r.props.showAlways&&e.preventDefault(),r.state.isCalloutVisible&&e&&0===e.screenX&&0===e.screenY?r.onHide():r.onShow()},r.onShow=function(){r.setState((function(e){return Object(ie.j)(e,{isCalloutVisible:!0})}))},r.onHide=function(){r.setState((function(e){return Object(ie.j)(e,{isCalloutVisible:!1})}))},r.state={isCalloutVisible:!1},r}return nn(t,e),t.prototype.render=function(){var e=this,t=this.props.attributions.length>0,r=this.state.isCalloutVisible,n=rn(this.props.theme),o=[n.attributionInfoIcon];return this.props.showAlways||this.state.isCalloutVisible||o.push(n.attributionHover),y.createElement("span",{className:o.join(" "),ref:function(t){return e.iconButtonElement=t}},t&&y.createElement(l.a,{iconProps:{iconName:"Info"},onMouseEnter:this.onShow,onMouseLeave:this.onHide,onMouseDown:this.onClickIcon,onClick:this.onClickIcon,tabIndex:-1,ariaLabel:en()}),r?this.iconButtonElement&&y.createElement(Qr.a,{className:n.attributionCallout,target:this.iconButtonElement,onDismiss:this.onHide,gapSpace:8,directionalHint:Zr.a.rightTopEdge,isBeakVisible:!1},y.createElement("div",{className:n.calloutContent,onMouseEnter:this.onShow,onMouseLeave:this.onHide,role:"alert"},y.createElement("span",null,y.createElement("div",{className:n.attributionTitle},tn())),this.props.attributions.map((function(e,t){return y.createElement("div",{key:t},e)})),this.props.children?y.createElement("p",null,this.props.children):null)):null)},t}(y.Component),an=Object(c.a)(on),sn=r(2243),cn=function(){return(cn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ln=Object(Ir.c)((function(e,t){void 0===t&&(t="inactive");var r=e.palette,n=r.neutralLighterAlt;return Object(Rr.db)({container:{position:"relative",display:"block",paddingTop:"13px",marginTop:"6px",marginBottom:"0px",width:"100%",backgroundColor:"disabled"===t?n:"inherit"},textField:{selectors:{"& .ms-TextField-fieldGroup, &.is-disabled .ms-TextField-fieldGroup":{backgroundColor:"transparent",zIndex:2},"input:disabled":cn({backgroundColor:"transparent"},{"-webkit-text-fill-color":r.neutralTertiaryAlt,"-webkit-opacity":1}),"& .ms-TextField-field":{paddingLeft:0}}},label:{display:"flex",alignItems:"center",position:"absolute",zIndex:"inactive"===t?1:3,transition:"top 200ms ease-out, color 200ms, font-size 200ms ease-out",fontSize:"inactive"===t?"17px":"12px",top:"inactive"===t?"0px":"-10px",height:"inactive"===t?"32px":"16px",color:"inactive"===t?r.neutralSecondaryAlt:r.neutralSecondary}})})),un=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),dn=function(){return(dn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},pn=function(e){function t(t){var r=e.call(this,t)||this;return r.textField=null,r.onFocus=function(){r.setState((function(e){return Object(ie.j)(e,{isActive:!0})}))},r.onBlur=function(){r.props.onBlur&&r.props.onBlur(),r.setState((function(e){return Object(ie.j)(e,{isActive:!1})}))},r.onRenderLabel=function(e){if(!e)return null;var t=r.getCSS();return y.createElement("div",{className:t.label},y.createElement("label",{htmlFor:e.id},e.label),r.props.onGetLabelAddon&&r.props.onGetLabelAddon(r.state.isActive))},r.getCSS=function(){var e=r.props.disabled||!r.props.isWritable?"disabled":r.props.value||r.state.isActive?"active":"inactive";return ln(r.props.theme,e)},r.state={isActive:!1},r}return un(t,e),t.prototype.render=function(){var e=this,t=this.getCSS();return y.createElement("div",{className:Object(g.a)(t.container,this.props.className)},y.createElement(sn.a,dn({},this.props,{"data-log-name":this.props.dataLogName,componentRef:function(t){e.props.componentRef&&e.props.componentRef(t),e.textField=t},onRenderLabel:this.onRenderLabel,onFocus:this.onFocus,onBlur:this.onBlur,onKeyPress:function(t){return e.onKeyPress(t)},className:t.textField,underlined:!0,disabled:this.props.disabled||!this.props.isWritable,multiline:this.props.multiline||!1,autoAdjustHeight:this.props.multiline||!1})))},t.prototype.onKeyPress=function(e){this.textField&&13===e.charCode&&this.props.onReturnPressed&&!this.props.multiline&&this.props.onReturnPressed(this.textField)},t}(y.Component),mn=Object(c.a)(pn),fn=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),hn=function(){return(hn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},gn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onGetLabelAddon=function(e){return t.props.value||e?y.createElement(an,{attributions:t.props.attributions,showAlways:e}):null},t}return fn(t,e),t.prototype.render=function(){return y.createElement(mn,hn({},this.props,{onGetLabelAddon:this.onGetLabelAddon}))},t}(y.Component);function bn(e){var t=0===e.emails.length?null:e.emails.map((function(t,r){var n="".concat(t.propertyUri,"-").concat(t.index),o=Object(ie.b)((function(r){return e.onUpdateEmail(Object(ie.j)(t,{newValue:r}))}));return y.createElement(gn,{componentRef:function(n){return e.textFieldRef(t.propertyUri,n,e.focusIndex+r/e.emails.length)},id:n,key:n,dataLogName:n,label:Je("Email"),value:t.newValue||"",isWritable:t.isWritable,onChange:function(e,t){return"string"==typeof t&&o(t)},onReturnPressed:e.onReturnPressed,attributions:t.attributions,errorMessage:(t.showErrorMessage?e.strings.emailErrorMessage:"")||(t.newValue.length>255?e.strings.inputLengthErrorMessage:""),onBlur:function(){return e.onBlurEmail(t)}})}));return y.createElement(zr,null,t)}function yn(e){var t=0===e.ims.length?null:e.ims.map((function(t,r){var n="".concat(t.propertyUri,"-").concat(t.index),o=Object(ie.b)((function(r){return e.onUpdateIM(Object(ie.j)(t,{newValue:r}))}));return y.createElement(gn,{componentRef:function(n){return e.textFieldRef(t.propertyUri,n,e.focusIndex+r/e.ims.length)},id:n,key:n,dataLogName:n,label:Je("IM"),value:t.newValue||"",isWritable:t.isWritable,errorMessage:t.newValue.length>255?e.strings.inputLengthErrorMessage:"",onChange:function(e,t){return"string"==typeof t&&o(t)},onReturnPressed:e.onReturnPressed,attributions:t.attributions})}));return y.createElement(zr,null,t)}var Pn=Object(Ir.c)((function(){return Object(Rr.db)({container:{flexGrow:1,marginTop:"-4px",flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"},nameFieldContainer:{flex:"1 1 200px"},nameFieldLeftSmallContainer:{flex:"0 0 60px",marginRight:"20px"},nameFieldRightSmallContainer:{flex:"0 0 60px",marginLeft:"20px"}})}));function Sn(e){var t=Pn();return y.createElement(zr,{className:t.container},be.map((function(r,n){if(r in e.names){var o=e.names[r];if(!o||null===o.oldValue&&null===o.newValue)return null;var a=function(e,t){switch(e){case"DisplayNamePrefix":return t.nameFieldLeftSmallContainer;case"Generation":return t.nameFieldRightSmallContainer;default:return t.nameFieldContainer}}(r,t),i=o.oldValue,s=Object(ie.b)((function(t){return e.onUpdateName(r,i,t)}));return y.createElement(gn,{componentRef:function(t){return e.textFieldRef(o.propertyUri,t,e.focusIndex+n/be.length)},key:r,dataLogName:r,id:r,className:a,label:Je(r),value:o.newValue||"",isWritable:o.isWritable,errorMessage:o.newValue.length>255?e.strings.inputLengthErrorMessage:"",onChange:function(e,t){return"string"==typeof t&&s(t)},onReturnPressed:e.onReturnPressed,attributions:o.attributions})}return null})))}var En=r(2524),vn=Object(Ir.c)((function(e){var t=e.palette;return Object(Rr.db)({deletableDatePicker:{border:"0px",margin:"8px 0px 8px 0px",padding:"0px"},container:{display:"flex",flexDirection:"row",alignItems:"flex-end",selectors:{"& .ms-Dropdown-container":{width:"100%"},"& .ms-Dropdown-label":{fontSize:"12px"},"& > div":{paddingRight:"12px"}}},monthPicker:{width:"160px"},datePicker:{width:"80px"},yearPicker:{width:"100px"},deleteButton:{selectors:{"&:hover":{backgroundColor:t.neutralLight},"&:hover .ms-Button-icon":{color:t.neutralPrimary}}},label:{display:"flex",fontSize:"12px",marginBottom:"4px",color:t.neutralSecondary,padding:0}})})),xn=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),An=function(e){function t(t){var r=e.call(this,t)||this;r.changeDayState=function(e,t){t&&r.props.otherContactProp.isWritable&&(r.setState((function(e){return Object(ie.j)(e,{selectedDayItem:t})})),r.updateStore(r.getSelectedYear(),r.getSelectedMonth(),wn(t.text)))},r.changeMonthState=function(e,t){t&&r.props.otherContactProp.isWritable&&(r.setState((function(e){return Object(ie.j)(e,{selectedMonthItem:t})})),r.updateStore(r.getSelectedYear(),wn(t.key.toString()),r.getSelectedDay()))},r.changeYearState=function(e,t){t&&r.props.otherContactProp.isWritable&&(r.setState((function(e){return Object(ie.j)(e,{selectedYearItem:t})})),r.updateStore(wn(t.text)||1604,r.getSelectedMonth(),r.getSelectedDay()))};var n=t.otherContactProp.newValue?t.otherContactProp.newValue:t.otherContactProp.oldValue?t.otherContactProp.oldValue:On(new Date(1604,0,1));return r.state={selectedDayItem:{key:n.getUTCDate().toString(),text:""},selectedMonthItem:{key:n.getUTCMonth().toString(),text:""},selectedYearItem:{key:n.getUTCFullYear().toString(),text:""}},r}return xn(t,e),t.prototype.render=function(){var e=this,t=this.state,r=t.selectedMonthItem,n=t.selectedDayItem,o=t.selectedYearItem,a=!this.props.otherContactProp.isWritable,i=vn(this.props.theme),s={optionsContainerWrapper:{maxHeight:"280px",overflowY:"scroll",overflowX:"hidden"},optionsContainer:{marginRight:"16px"}};return y.createElement("fieldset",{className:i.deletableDatePicker},y.createElement("legend",{className:i.label},this.props.label," ",y.createElement(an,{attributions:this.props.attributions,showAlways:!1})),y.createElement("div",{className:i.container},y.createElement("div",{className:i.monthPicker},y.createElement(En.a,{allowFreeform:!0,componentRef:function(t){!a&&e.props.componentRef(t,e.props.focusIndex)},disabled:a,ariaLabel:Je("Month"),selectedKey:r&&r.key,onChange:this.changeMonthState,options:this.getMonthOptions(),styles:s})),y.createElement("div",{className:i.datePicker},y.createElement(En.a,{allowFreeform:!0,componentRef:function(t){!a&&e.props.componentRef(t,e.props.focusIndex,!0)},disabled:a,ariaLabel:Je("Day"),selectedKey:n&&n.key,onChange:this.changeDayState,options:this.getDayOptions(),styles:s})),y.createElement("div",{className:i.yearPicker},y.createElement(En.a,{allowFreeform:!0,componentRef:function(t){!a&&e.props.componentRef(t,e.props.focusIndex,!0)},disabled:a,ariaLabel:Je("Year"),selectedKey:o&&o.key,onChange:this.changeYearState,options:this.getYearOptions(),styles:s})),this.props.onDeleted?y.createElement(l.a,{className:i.deleteButton,onClick:this.props.onDeleted,iconProps:{iconName:"Delete"},title:this.props.strings.removeDate,ariaLabel:this.props.strings.removeDate}):null))},t.prototype.updateStore=function(e,t,r){this.props.onUpdate(Object(ie.j)(this.props.otherContactProp,{newValue:On(new Date(e,t,r,11,59))}))},t.prototype.getSelectedYear=function(){return wn(this.state.selectedYearItem.key.toString())||1604},t.prototype.getSelectedMonth=function(){return wn(this.state.selectedMonthItem.key.toString())},t.prototype.getSelectedDay=function(){return wn(this.state.selectedDayItem.key.toString())},t.prototype.getDayOptions=function(){return(e=this.getSelectedMonth(),t=this.getSelectedYear(),Cn(1,function(e,t){return void 0===t&&(t=1604),new Date(t,e+1,0).getDate()}(e,t))).map((function(e){return{key:e,text:e}}));var e,t},t.prototype.getMonthOptions=function(){return(e=this.props.strings.monthNames,[e.january,e.february,e.march,e.april,e.may,e.june,e.july,e.august,e.september,e.october,e.november,e.december]).map((function(e,t){return{key:t.toString(),text:e}}));var e},t.prototype.getYearOptions=function(){return[{key:1604..toString(),text:Je("Year")}].concat(Cn(1900,(new Date).getUTCFullYear()).reverse().map((function(e){return{key:e,text:e}})))},t}(y.Component),Nn=Object(c.a)(An);function On(e){var t=6e4*e.getTimezoneOffset();return new Date(e.getTime()-t)}function Cn(e,t){return Array.apply(null,new Array(t-e+1)).map((function(t,r){return(r+e).toString()}))}function wn(e){return parseInt(e,10)}function kn(e){if(0===e.otherContactProps.length)return null;var t=Se.map((function(t,r){return e.otherContactProps.filter((function(e){return e.propertyUri===t})).map((function(t){var n="".concat(t.propertyUri,"-").concat(t.index),o=Object(ie.b)((function(r){e.onUpdateOtherContactProp(Object(ie.j)(t,{newValue:r}))}));return gr(t)?y.createElement(Nn,{componentRef:function(r,n,o){return e.focusTargetRef(o?void 0:t.propertyUri,r,n)},focusIndex:e.focusIndex+r/Se.length,onUpdate:e.onUpdateOtherContactProp,onDeleted:t.isWritable?function(){e.onRemoveOtherContactDateProp(t)}:void 0,strings:e.strings,otherContactProp:t,key:n,label:Je(t.propertyUri),attributions:t.attributions}):y.createElement(gn,{componentRef:function(n){return e.focusTargetRef(t.propertyUri,n,e.focusIndex+r/Se.length)},id:n,key:n,dataLogName:n,label:Je(t.propertyUri),value:t.newValue||"",isWritable:t.isWritable,errorMessage:t.newValue.length>255?e.strings.inputLengthErrorMessage:"",onChange:function(e,t){"string"==typeof t&&o(t)},attributions:t.attributions,onReturnPressed:e.onReturnPressed})}))}));return y.createElement(Jr,{header:e.strings.otherPropertiesHeader},y.createElement(zr,null,t))}var jn=Object(Ir.c)((function(){return Object(Rr.db)({notesEditor:{width:"100%",marginTop:"12px",marginBottom:"40px"}})}));function Vn(e){var t=e.textFieldRef,r=e.strings,n=e.notes,o=e.onUpdatePersonalNote,a=e.focusIndex;return y.createElement(Jr,{header:r.privateNotes},n.map((function(e){var i=Object(ie.b)((function(t){e.isWritable&&o(Object(ie.j)(e,{newValue:t}))}));return y.createElement(sn.a,{disabled:!e.isWritable,className:jn().notesEditor,ariaLabel:Dn(r.privateNotes,r.privateNotesSection,e),label:n.length>1?Dn(r.privateNotes,r.privateNotesSection,e):void 0,componentRef:function(e){return t("PersonaBodies",e,a)},multiline:!0,autoAdjustHeight:!0,rows:4,value:e.newValue||"",resizable:!1,placeholder:r.privateNotesPlaceholder,key:e.index,"data-log-name":"PersonaBodies-".concat(e.index),onChange:function(e,t){"string"==typeof t&&i(t)}})})))}function Dn(e,t,r){return 0===r.attributions.length?e:t({p0:r.attributions.join(" - ")})}function Un(e){var t=0===e.phones.length?null:e.phones.map((function(t,r){var n="".concat(t.propertyUri,"-").concat(t.index),o=Object(ie.b)((function(r){return e.onUpdatePhone(Object(ie.j)(t,{newValue:r}))}));return y.createElement(gn,{componentRef:function(n){return e.textFieldRef(t.propertyUri,n,e.focusIndex+r/e.phones.length)},id:n,key:n,dataLogName:n,label:qe(t.propertyUri),value:t.newValue||"",isWritable:t.isWritable,errorMessage:t.newValue.length>255?e.strings.inputLengthErrorMessage:"",onChange:function(e,t){return"string"==typeof t&&o(t)},onReturnPressed:e.onReturnPressed,attributions:t.attributions})}));return y.createElement(zr,null,t)}var Tn=r(1577),Ln=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Bn=y.lazy((function(){return Promise.all([r.e(0),r.e(244)]).then(r.bind(null,2844)).then((function(e){return{default:e.StandalonePhotoPicker}}))})),Mn=function(e){function t(t){var r=e.call(this,t)||this;return r.showPhotoPicker=function(){r.setState((function(e){return Object(ie.j)(e,{isPhotoPickerVisible:!0})}))},r.hidePhotoPicker=function(){r.setState((function(e){return Object(ie.j)(e,{isPhotoPickerVisible:!1})}))},r.state={isPhotoPickerVisible:!1},r}return Ln(t,e),t.prototype.render=function(){var e=this;return y.createElement(Tn.a,{onClick:this.showPhotoPicker,title:this.props.title,size:this.props.size},y.createElement(y.Suspense,{fallback:y.createElement("div",null)},this.state.isPhotoPickerVisible&&y.createElement(Bn,{personDisplayName:this.props.personDisplayName,personImageUrl:this.props.personImageUrl,strings:this.props.strings,onUpload:function(t,r,n){return e.onPhotoUploaded(t,r,n)},onDismiss:this.hidePhotoPicker})))},t.prototype.onPhotoUploaded=function(e,t,r){t(),this.hidePhotoPicker(),this.props.onUpload&&this.props.onUpload(e)},t}(y.Component),Wn=function(){return(Wn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Rn=Object(Ir.c)((function(e){return Object(Rr.db)({headerRow:Wn(Wn({justifyContent:"space-between",lineHeight:"14px;",marginTop:"6px"},Rr.f.small),!e&&{backgroundColor:Rr.g.neutralLighterAlt}),header:{color:Rr.g.neutralSecondary},addressFieldsContainer:{flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap",display:"flex"},fullLineField:{flex:"0 0 100%"},halfLineField:{flex:"0 0 192px"}})})),In=function(){return(In=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Fn=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};function Hn(e){var t=["Street","City","State","PostalCode","Country"],r=Rn(e.postalAddress.isWritable);return y.createElement("div",{className:r.addressFieldsContainer},t.map((function(n,o){var a=Object(ie.b)((function(t){var r;e.postalAddress.newValue&&e.onUpdatePostalAddress(Object(ie.j)(e.postalAddress,{newValue:Object(ie.j)(e.postalAddress.newValue,(r={},r[n]=t,r))}))})),i="".concat(e.postalAddress.propertyUri,"-").concat(e.postalAddress.index,"-").concat(n);return y.createElement(mn,{componentRef:function(r){return e.textFieldRef(0===o?e.postalAddress.propertyUri:void 0,r,e.focusIndex+o/(100*t.length))},id:i,key:i,dataLogName:i,label:Je(n),className:0===o?r.fullLineField:r.halfLineField,value:e.postalAddress.newValue&&e.postalAddress.newValue[n]||"",errorMessage:(e.postalAddress.newValue&&e.postalAddress.newValue[n]||"").length>255?e.strings.inputLengthErrorMessage:"",isWritable:e.postalAddress.isWritable,multiline:"Street"===n,onChange:function(e,t){"string"==typeof t&&a(t)},onReturnPressed:e.onReturnPressed})})))}function Yn(e){var t=e.focusIndex,r=Fn(e,["focusIndex"]),n=r.postalAddresses.map((function(e,n){return y.createElement(Jr,{key:n,header:(o=Je(e.propertyUri),a=e.attributions,y.createElement(_r,null,o," ",y.createElement(an,{attributions:a,showAlways:!1})))},y.createElement(Hn,In({postalAddress:e,focusIndex:t+n/r.postalAddresses.length},r)));var o,a}));return y.createElement(zr,null,n)}var _n=r(2249),Gn=r(1996),zn=r(2534),Kn=r(2044),Xn=r(2892),$n=r(2890),Jn=r(2891),qn=r(2043),Qn=r(878),Zn=r(2869),eo=Object(Ir.c)((function(e){return Object(Rr.db)({button:{margin:"10px 14px 0px 0px",padding:"0px",minWidth:"120px",maxWidth:"160px",color:e.palette.themePrimary,selectors:{"& .ms-Button-menuIcon, & .ms-Button-icon":{color:e.palette.themePrimary}}}})})),to=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var ro=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return to(t,e),t.prototype.render=function(){var e,t,r,n=this.props,o=function(e,t){var r=lr(e,t),n=ye.filter((function(e){return!r[e]}));return Object(le.a)(n.map(mt))}(n.originalContact,n.changeSet),a=(e=n.originalContact,t=n.changeSet,r=n.isEnterprise,bt(e,t,wt,Ne,r)),i=function(e,t,r){var n=bt(e,t,gt,Ae,r);return Object(ue.a)(n,(function(e){return Qe(e)}))}(n.originalContact,n.changeSet,n.isEnterprise),s=function(e,t,r){return bt(e,t,ir,Ce,r)}(n.originalContact,n.changeSet,n.isEnterprise),c=function(e,t,r){return bt(e,t,Tt,we,r)}(n.originalContact,n.changeSet,n.isEnterprise),l=function(e,t,r){return bt(e,t,It,Pe,r)}(n.originalContact,n.changeSet,n.isEnterprise),u=function(e,t,r){return bt(e,t,St,Oe,r)}(n.originalContact,n.changeSet,n.isEnterprise),d=function(e,t,r){return bt(e,t,zt,ke,r)}(n.originalContact,n.changeSet,n.isEnterprise),p=eo(n.theme),m=a.slice(0,1),f=Object(Zn.a)(Ae,i.filter(Le)),h=Object(Zn.a)(Ae,i.filter(Be));0===f.length&&(f=h,h=[]);var g=function(e){return{key:e,name:Qe(e),onClick:function(){n.onAddPhone(e)}}},b=n.disabled||a.length+u.length+o.length+f.length+h.length+s.length+l.length+c.length===0;return y.createElement(Qn.a,{"data-log-name":"ContactEditorAdd",className:p.button,disabled:b,menuProps:{items:m.map((function(e){return{key:e,name:Je("Email"),onClick:function(){n.onAddEmail(e)}}})).concat(u.map((function(e){return{key:e,name:Je("IM"),onClick:function(){n.onAddIm(e)}}}))).concat(no(Je("AddNameSubmenu"),o.map((function(e){return{key:e,name:Je(e),onClick:function(){window.setTimeout((function(){return n.onAddName(e)}),0)}}}))),no(Je("AddPhoneSubmenu"),f.map(g).concat(no(Je("AddPhoneOtherSubmenu"),h.map(g),Je("AddPhoneSubmenu").concat(Je("AddPhoneOtherSubmenu"))))),no(Je("AddWorkSubmenu"),s.map((function(e){return{key:e,name:Je(e),onClick:function(){n.onAddWorkDetail(e)}}}))),no(Je("AddAddressSubmenu"),c.map((function(e){return{key:e,name:Ze(e),onClick:function(){n.onAddPostalAddress(e)}}}))),no(Je("AddOtherSubmenu"),l.map((function(e){return{key:e,name:Je(e),onClick:function(){n.onAddOtherContactProp(e)}}})))).concat(d.map((function(e){return{key:e,name:Je("PersonaBodies"),onClick:function(){n.onAddPersonalNotes(e)}}})))},iconProps:{iconName:"Add"}},n.caption)},t}(y.Component);function no(e,t,r){return r=r||e,0===t.length?[]:{key:r,name:e,subMenuProps:{items:t}}}var oo=Object(P.c)((function(e,t){return{originalContact:Lr.getSelectors(e).originalContact||{},changeSet:Lr.getSelectors(e).changeSet}}),(function(e,t){return{onAddEmail:function(t){return e(R({availableEmail:t}))},onAddIm:function(t){return e(M({availableIm:t}))},onAddName:function(t){return e(C({availableName:t}))},onAddOtherContactProp:function(t){return e(T({availableOtherContactProp:t}))},onAddPhone:function(t){return e(k({availablePhone:t}))},onAddPostalAddress:function(t){return e(D({availablePostalAddress:t}))},onAddWorkDetail:function(t){return e(_({availableWorkDetail:t}))},onAddPersonalNotes:function(t){return e(H({availableNotes:t}))}}}))(Object(c.a)(ro)),ao=Object(Ir.c)((function(e){var t=e.palette,r=t.neutralLighter;return Object(Rr.db)({button:{margin:"14px 14px 0px 0px",padding:"0px",minWidth:"80px",maxWidth:"100px",backgroundColor:t.neutralLighter,borderColor:t.neutralLighter,color:t.neutralPrimary,selectors:{"&.ms-Button--primary":{backgroundColor:t.themePrimary,color:t.white},"&.ms-Button--primary:hover":{backgroundColor:t.themeDarkAlt,color:t.white},"&.ms-Button--primary:active":{backgroundColor:t.themeDark,color:t.white},"&.is-disabled, &.ms-Button--primary.is-disabled":{backgroundColor:t.neutralLighter,color:t.neutralTertiary},"@media screen and (-ms-high-contrast: active)":{"&.is-disabled, &.ms-Button--primary.is-disabled":{backgroundColor:t.neutralLighter,color:"graytext"}},"&.ms-Button--default:hover":{backgroundColor:t.neutralLight,color:t.black},"&.ms-Button--default:active":{backgroundColor:t.neutralTertiaryAlt,color:t.neutralDark}}},ghostedSaveBar:{display:"flex",flexDirection:"row"},ghostedButton:{margin:"14px 12px 0px 0px",height:"32px",maxWidth:"80px",minWidth:"80px",backgroundColor:r,borderColor:r},ghostedAddMoreButton:{display:"flex",flexDirection:"column",margin:"20px 0px 0px 0px",padding:"0px",minWidth:"120px",maxWidth:"120px",height:"22px",backgroundColor:r,borderColor:r},spinner:{width:"100%",margin:"auto"}})})),io=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),so=function(){return(so=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},co=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return io(t,e),t.prototype.render=function(){return-1!==["saving","failed"].indexOf(this.props.editorState)?y.createElement($n.a,null,lo(this.props)):y.createElement(lo,so({},this.props))},t}(y.Component);function lo(e){var t="loading"===e.editorState||"loadErrorDialogOpen"===e.editorState,r=ao(e.theme),n="editing"===e.editorState;return y.createElement("div",{className:e.className},t?y.createElement("div",{className:r.ghostedSaveBar},y.createElement("span",{className:r.ghostedButton}),y.createElement("span",{className:r.ghostedButton}),y.createElement("span",{className:r.ghostedAddMoreButton})):y.createElement("div",null,y.createElement(uo,so({},e)),y.createElement(po,so({},e)),y.createElement(oo,{disabled:!n,caption:e.strings.addMore,isEnterprise:e.isEnterprise})),"discardDialogOpen"===e.editorState?y.createElement(fo,so({},e)):null,"loadErrorDialogOpen"===e.editorState?y.createElement(ho,so({},e)):null)}function uo(e){var t=ao(e.theme),r=!e.hasChanges,n="failed"===e.editorState?e.onCancel:e.onSave;return y.createElement(_n.a,{className:t.button,onClick:n,disabled:r,"data-log-name":"ContactEditorSave",onFocus:e.onSaveButtonFocus,theme:e.theme},function(e){switch(e.editorState){case"saving":case"discardDialogOpen":return y.createElement(Jn.a,{className:ao(e.theme).spinner,size:qn.a.medium});case"failed":return e.strings.close;case"editing":return e.createMode?e.strings.create:e.strings.save;case"idle":case"loading":case"loadErrorDialogOpen":return"";default:return Object(o.a)(e.editorState)}}(e))}function po(e){var t=ao(e.theme),r="saving"===e.editorState||"failed"===e.editorState;return y.createElement(Gn.a,{className:t.button,onClick:e.onCancel,disabled:r,"data-log-name":"ContactEditorCancel",theme:e.theme},e.createMode?e.strings.discard:e.strings.cancel)}function mo(e){var t=e.onNotSaveInDialog,r=e.onCancelInDialog,n=e.strings,o=e.theme,a=ao(o);return y.createElement(zn.a,null,y.createElement(_n.a,{onClick:t,text:n.discardDialogYes,"data-log-name":"EditContactSaveDialogNo",theme:o,className:a.button}),y.createElement(Gn.a,{onClick:r,text:n.discardDialogCancel,"data-log-name":"EditContactSaveDialogCancel",theme:o,className:a.button}))}function fo(e){var t=e.onCancelInDialog,r=e.strings;return y.createElement(go,{onCancel:t,title:r.discardDialogTitle,subText:r.discardDialogSubText,dialogType:Kn.a.close,renderButtons:function(){return y.createElement(mo,so({},e))}})}function ho(e){var t=e.onCancelInDialog,r=e.strings,n=e.theme,o=ao(n);return y.createElement(go,{onCancel:t,title:r.loadErrorDialogTitle,dialogType:Kn.a.normal,renderButtons:function(){return y.createElement(zn.a,null,y.createElement(_n.a,{onClick:e.onCancelInDialog,text:r.errorDialogClose,theme:n,className:o.button}))}})}function go(e){return y.createElement(Xn.a,{"data-log-name":"EditContactSaveDialog",hidden:!1,onDismiss:e.onCancel,dialogContentProps:{type:e.dialogType||Kn.a.normal,title:e.title,subText:e.subText},modalProps:{isBlocking:!0}},e.renderButtons())}function bo(e){if(0===e.workDetails.length)return null;var t=e.workDetails.map((function(t,r){var n="".concat(t.propertyUri,"-").concat(t.index),o=Object(ie.b)((function(r){return e.onUpdateWorkDetail(Object(ie.j)(t,{newValue:r}))}));return y.createElement(gn,{componentRef:function(n){return e.textFieldRef(t.propertyUri,n,e.focusIndex+r/e.workDetails.length)},id:n,key:n,dataLogName:n,label:Je(t.propertyUri),value:t.newValue||"",isWritable:t.isWritable,errorMessage:t.newValue.length>255?e.strings.inputLengthErrorMessage:"",onChange:function(e,t){"string"==typeof t&&o(t)},onReturnPressed:e.onReturnPressed,attributions:t.attributions})}));return y.createElement(Jr,{header:e.strings.workDetailsHeader},y.createElement(zr,null,t))}var yo="calc(100vh - ".concat(78,"px)"),Po="calc(100vh - ".concat(179,"px)"),So=Object(Ir.c)((function(e){var t,r,n=e.palette,o={leftPaneTitle:e.fonts.xxLarge,leftPaneSubTitle:e.fonts.medium,leftPaneText:e.fonts.medium};return Object(Rr.db)(o,{editorRoot:{border:"1px solid transparent",width:"".concat(798,"px"),maxHeight:yo,display:"flex",flexDirection:"row",overflow:"hidden",selectors:(t={"& h1, & h2, & h3":{marginTop:0,marginBottom:0}},t["@media screen and (max-width: ".concat(798,"px)")]={width:"".concat(498,"px")},t)},svg:{margin:"auto",height:"200px",width:"80%",display:"block"},primaryStroke:{stroke:n.themePrimary,fill:"none"},secondaryStroke:{stroke:n.themeTertiary,fill:"none"},leftPane:{boxSizing:"border-box",minWidth:"".concat(300,"px"),backgroundColor:n.neutralLighter,paddingLeft:"".concat(32,"px"),paddingRight:"".concat(32,"px"),paddingTop:"".concat(40,"px"),paddingBottom:"".concat(40,"px"),overflow:"auto",color:n.neutralPrimary,lineHeight:"18px",selectors:(r={},r["@media screen and (max-width: ".concat(798,"px)")]={display:"none"},r)},leftPaneTitle:{paddingBottom:"40px",paddingTop:"10px",lineHeight:"1.2"},leftPaneSubTitle:{fontWeight:"600"},leftPaneText:{marginTop:"0px",whiteSpace:"pre-wrap"},rightPane:{minWidth:"".concat(500,"px"),display:"flex",flexDirection:"column"},rightBodyTopBorder:{selectors:{"div&":{borderTop:"1px solid ".concat(n.neutralLighter)}}},rightBody:{borderTop:"1px solid ".concat(n.white),maxHeight:Po,padding:"0px",overflowY:"auto",marginTop:"".concat(39,"px")},rightBodyContent:{position:"relative",maxWidth:"".concat(404,"px"),paddingRight:"8px",paddingLeft:"".concat(48,"px"),paddingTop:"0px",paddingBottom:"0px",selectors:{"& .ms-Persona-initials":{color:"#FFFFFF"}}},rightFooter:{minHeight:"".concat(60,"px"),height:"".concat(60,"px"),padding:"0px ".concat(48,"px"),borderTop:"1px solid ".concat(n.neutralLighter),boxSizing:"border-box"},rightHeader:{paddingLeft:"".concat(48,"px"),maxWidth:"".concat(435,"px"),height:"10px",paddingTop:"0px",margin:"0px"},closeButtonOuter:{width:"".concat(31,"px"),textAlign:"center",position:"absolute",right:"1px",top:0},closeButton:{marginTop:"2px",color:n.neutralSecondary,selectors:{"&:hover .ms-Button--icon ":{color:n.themeDarker}}},errorBar:{margin:"0 auto 20px auto",maxWidth:"".concat(404,"px"),selectors:{"& .ms-MessageBar-icon":{margin:"8px 0 8px 8px"},"& .ms-MessageBar-text":{margin:"8px"}}},errorBarMessage:{color:n.black},editorOverlay:{zIndex:100,backgroundColor:n.white,opacity:.7},doughboy:{selectors:{"& .ms-Persona-coin .ms-Persona-initials":{fontSize:"32px",backgroundColor:n.neutralQuaternaryAlt}}}})})),Eo=r(1789),vo=r(327),xo=r(1404);function Ao(e){var t=e.styles;return y.createElement("svg",{id:"Layer_1",className:t.svg,"data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 187.03 110.33","aria-hidden":"true"},y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"21.53",y1:"94.83",x2:"26.53",y2:"94.83"}),y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"132.53",y1:"94.83",x2:"149.53",y2:"94.83"}),y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"34.53",y1:"94.83",x2:"41.53",y2:"94.83"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M104.75,71.56l.06.06a4.62,4.62,0,0,0,6.54,0h0",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M100.16,83.1A9.51,9.51,0,0,0,108,87.3a9,9,0,0,0,7.89-4.2",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M98.13,67.75A4,4,0,0,0,94.8,66a3.79,3.79,0,0,0-3.34,1.78",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M124.46,67.75A4,4,0,0,0,121.13,66a3.79,3.79,0,0,0-3.34,1.78",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M132,55V74.71a24,24,0,0,1-24,24h0a24,24,0,0,1-24-24V55.05",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M84,64.62h-.51A5.41,5.41,0,0,0,78,70v.17a5.41,5.41,0,0,0,5.41,5.41H84",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M132,64.62h.16A5.41,5.41,0,0,1,137.52,70v.17a5.41,5.41,0,0,1-5.41,5.41H132",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M153,125.5v-5.33a19.56,19.56,0,0,0-19.56-19.56H124",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M92,100.62H82.51A19.56,19.56,0,0,0,63,120.17v5.33",transform:"translate(-17.97 -15.67)"}),y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"6",className:t.primaryStroke,x1:"73.98",y1:"76.95",x2:"73.98",y2:"84.95"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M91.94,101.06s-.36,15.56,15.56,15.56c16.45,0,16.45-15.56,16.45-15.56V92.62",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M131.55,72.91",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M91.57,98.06c-1.77-.83-3.27-4.3-4.89-5.37s-4.72-.18-6.19-1.48-1-4.55-2.31-6.05S73.7,83.65,72.65,82s.26-4.66-.55-6.47-3.88-2.74-4.43-4.66,1.54-4.38,1.27-6.36-3-3.73-3-5.75,2.69-3.81,3-5.75-1.81-4.48-1.27-6.36S71.29,43.76,72.1,42s-.5-4.81.55-6.47,4.27-1.69,5.54-3.19.84-4.75,2.31-6.05,4.55-.4,6.19-1.48,2.1-4.32,3.88-5.14,4.47.93,6.35.37,3.2-3.53,5.15-3.81,4,2.19,6,2.19,4.09-2.46,6-2.19,3.3,3.26,5.15,3.81,4.59-1.19,6.35-.37,2.25,4.07,3.88,5.14,4.72.18,6.19,1.48,1,4.55,2.31,6.05,4.48,1.52,5.54,3.19-.26,4.66.55,6.47,3.88,2.74,4.43,4.66S146.86,51,147.14,53s3,3.73,3,5.75-2.69,3.81-3,5.75,1.81,4.48,1.27,6.36-3.63,2.87-4.43,4.66.5,4.81-.55,6.47-4.27,1.69-5.54,3.19-.84,4.75-2.31,6.05-4.55.4-6.19,1.48-3.09,4.54-4.87,5.37",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M84,55.23a2.29,2.29,0,0,0,1.65-.64c1.7-1.12,2.19-4.5,4-5.36s4.66,1,6.62.38,3.34-3.68,5.37-4,4.19,2.28,6.24,2.28,4.26-2.57,6.24-2.28,3.44,3.4,5.37,4,4.79-1.24,6.62-.38,2.35,4.25,4,5.36a3.51,3.51,0,0,0,1.23.47",transform:"translate(-17.97 -15.67)"}),y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"77.5",y1:"109.83",x2:"147.53",y2:"109.83"}),y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"30.5",y1:"109.83",x2:"60.53",y2:"109.83"}),y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"0.5",y1:"109.83",x2:"19.53",y2:"109.83"}),y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"156.5",y1:"109.83",x2:"186.53",y2:"109.83"}))}var No={title:Ye.declareString("contact-editor.contactEditorStrings.infoTextNewContact.title"),description:Ye.declareStringWithPlaceholders("contact-editor.contactEditorStrings.infoTextNewContact.description")},Oo={title:Ye.declareString("contact-editor.contactEditorStrings.infoTextAddContact.title"),description:Ye.declareStringWithPlaceholders("contact-editor.contactEditorStrings.infoTextAddContact.description")},Co={title:Ye.declareString("contact-editor.contactEditorStrings.infoTextEditContact.title"),description:Ye.declareStringWithPlaceholders("contact-editor.contactEditorStrings.infoTextEditContact.description")},wo={title:Ye.declareString("contact-editor.contactEditorStrings.infoTextEditLinkedContact.title"),description:Ye.declareStringWithPlaceholders("contact-editor.contactEditorStrings.infoTextEditLinkedContact.description"),subTitle:Ye.declareString("contact-editor.contactEditorStrings.infoTextEditLinkedContact.subTitle"),subDescription:Ye.declareStringWithPlaceholders("contact-editor.contactEditorStrings.infoTextEditLinkedContact.subDescription")};function ko(e){var t=e.styles,r=e.strings,n=e.editorMode,a=e.containsNonWritable,i=function(e,t){switch(e){case"NewContact":return No;case"AddContact":return Oo;case"EditContact":return t?wo:Co;default:return Object(o.a)(e),No}}(n,e.isLinkedContact);return y.createElement("section",{className:t.leftPane,role:"region","aria-labelledby":"lpc-contact-editor-title"},y.createElement("h2",{className:t.leftPaneTitle,id:"lpc-contact-editor-title"},i.title()),y.createElement("p",{className:t.leftPaneText},y.createElement(Eo.a,{text:i.description,placeholders:{p0:y.createElement("strong",null,r.addMore)}})),y.createElement(Ao,{styles:t}),a&&i.subTitle&&y.createElement("h2",{className:t.leftPaneSubTitle},i.subTitle()),a&&i.subDescription&&y.createElement("p",{className:t.leftPaneText},y.createElement(Eo.a,{text:i.subDescription,placeholders:{p0:y.createElement(vo.a,{iconName:"Info"})}})),i.link&&i.linkLabel&&y.createElement(xo.a,{href:i.link()},i.linkLabel()))}var jo=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Vo=function(){return(Vo=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Do=function(e,t,r,n){return new(r||(r=Promise))((function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((n=n.apply(e,t||[])).next())}))},Uo=function(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},To=Object(a.a)((function(e){return Vo(Vo({},e),{save:Ye.declareString("contact-editor.contactEditorStrings.save")(),edit:Ye.declareString("contact-editor.contactEditorStrings.edit")(),remove:Ye.declareString("contact-editor.contactEditorStrings.remove")(),cancel:Ye.declareString("contact-editor.contactEditorStrings.cancel")(),close:Ye.declareString("contact-editor.contactEditorStrings.close")(),saving:Ye.declareString("contact-editor.contactEditorStrings.saving")(),create:Ye.declareString("contact-editor.contactEditorStrings.create")(),tryAgain:Ye.declareString("contact-editor.contactEditorStrings.tryAgain")(),discard:Ye.declareString("contact-editor.contactEditorStrings.discard")(),closeButtonAccessibilityTitle:Ye.declareString("contact-editor.contactEditorStrings.closeButtonAccessibilityTitle")(),discardDialogTitle:Ye.declareString("contact-editor.contactEditorStrings.discardDialogTitle")(),discardDialogSubText:Ye.declareString("contact-editor.contactEditorStrings.discardDialogSubText")(),saveErrorDialogTitleEmailError:Ye.declareString("contact-editor.contactEditorStrings.saveErrorDialogTitleEmailError")(),saveErrorDialogTitleError:Ye.declareString("contact-editor.contactEditorStrings.saveErrorDialogTitleError")(),saveErrorDialogTextEmailError:Ye.declareString("contact-editor.contactEditorStrings.saveErrorDialogTextEmailError")(),loadErrorDialogTitle:Ye.declareString("contact-editor.contactEditorStrings.loadErrorDialogTitle")(),discardDialogYes:Ye.declareString("contact-editor.contactEditorStrings.discardDialogYes")(),discardDialogCancel:Ye.declareString("contact-editor.contactEditorStrings.discardDialogCancel")(),errorDialogCancel:Ye.declareString("contact-editor.contactEditorStrings.errorDialogCancel")(),errorDialogClose:Ye.declareString("contact-editor.contactEditorStrings.errorDialogClose")(),rotate:Ye.declareString("contact-editor.contactEditorStrings.rotate")(),clockwise:Ye.declareString("contact-editor.contactEditorStrings.clockwise")(),counterClockwise:Ye.declareString("contact-editor.contactEditorStrings.counterClockwise")(),pivot:Ye.declareString("contact-editor.contactEditorStrings.pivot")(),zoomAtMax:Ye.declareString("contact-editor.contactEditorStrings.zoomAtMax")(),emailErrorMessage:Ye.declareString("contact-editor.contactEditorStrings.emailErrorMessage")(),navigationWarning:Ye.declareString("contact-editor.contactEditorStrings.navigationWarning")(),inputLengthErrorMessage:Ye.declareString("contact-editor.contactEditorStrings.inputLengthErrorMessage")(),addToFavorites:Ye.declareString("contact-editor.contactEditorStrings.addToFavorites")(),removeFromFavorites:Ye.declareString("contact-editor.contactEditorStrings.removeFromFavorites")(),contactEditFormAriaLabel:Ye.declareString("contact-editor.contactEditorStrings.contactEditFormAriaLabel")(),contactInformation:Ye.declareString("contact-editor.contactEditorStrings.contactInformation")(),workDetailsHeader:Ye.declareString("contact-editor.contactEditorStrings.workDetailsHeader")(),postalAddressesHeader:Ye.declareString("contact-editor.contactEditorStrings.postalAddressesHeader")(),otherPropertiesHeader:Ye.declareString("contact-editor.contactEditorStrings.otherPropertiesHeader")(),privateNotes:Ye.declareString("contact-editor.contactEditorStrings.privateNotes")(),privateNotesSection:Ye.declareStringWithPlaceholders("contact-editor.contactEditorStrings.privateNotesSection"),privateNotesPlaceholder:Ye.declareString("contact-editor.contactEditorStrings.privateNotesPlaceholder")(),addMore:Ye.declareString("contact-editor.contactEditorStrings.addMore")(),dayNames:{monday:Ye.declareString("contact-editor.contactEditorStrings.contactEditorDayNamesStrings.monday")(),tuesday:Ye.declareString("contact-editor.contactEditorStrings.contactEditorDayNamesStrings.tuesday")(),wednesday:Ye.declareString("contact-editor.contactEditorStrings.contactEditorDayNamesStrings.wednesday")(),thursday:Ye.declareString("contact-editor.contactEditorStrings.contactEditorDayNamesStrings.thursday")(),friday:Ye.declareString("contact-editor.contactEditorStrings.contactEditorDayNamesStrings.friday")(),saturday:Ye.declareString("contact-editor.contactEditorStrings.contactEditorDayNamesStrings.saturday")(),sunday:Ye.declareString("contact-editor.contactEditorStrings.contactEditorDayNamesStrings.sunday")()},dayShortNames:{monday:Ye.declareString("contact-editor.contactEditorStrings.contactEditorDayShortNamesStrings.monday")(),tuesday:Ye.declareString("contact-editor.contactEditorStrings.contactEditorDayShortNamesStrings.tuesday")(),wednesday:Ye.declareString("contact-editor.contactEditorStrings.contactEditorDayShortNamesStrings.wednesday")(),thursday:Ye.declareString("contact-editor.contactEditorStrings.contactEditorDayShortNamesStrings.thursday")(),friday:Ye.declareString("contact-editor.contactEditorStrings.contactEditorDayShortNamesStrings.friday")(),saturday:Ye.declareString("contact-editor.contactEditorStrings.contactEditorDayShortNamesStrings.saturday")(),sunday:Ye.declareString("contact-editor.contactEditorStrings.contactEditorDayShortNamesStrings.sunday")()},contactEditorDatePickerLocale:Ye.declareString("contact-editor.contactEditorStrings.contactEditorDatePickerLocale")(),removeDate:Ye.declareString("contact-editor.contactEditorStrings.removeDate")(),addContactPhotoFor:Ye.declareStringWithPlaceholders("contact-editor.contactEditorStrings.addContactPhotoFor"),changeContactPhotoFor:Ye.declareStringWithPlaceholders("contact-editor.contactEditorStrings.changeContactPhotoFor"),addContactPhoto:Ye.declareString("contact-editor.contactEditorStrings.addContactPhoto")(),changeContactPhoto:Ye.declareString("contact-editor.contactEditorStrings.changeContactPhoto")()})}));function Lo(e,t,r){r||it(t.changeSet,t.originalContact,t.editorMode)||"failed"===t.editorState?(t.onClose(null),e(te())):e(Q())}function Bo(e){return"string"==typeof e?e:e instanceof Error?e.message:"Error"}var Mo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.focusTargets={},t.focusOrder=[],t.formContainer=null,t.focusRef=function(e,r,n){e&&r&&(t.focusTargets[e]=r),r&&t.focusOrder&&Object(b.a)(t.focusOrder,(function(e){return e.element===r}))<0&&(t.focusOrder.push({focusIndex:n,element:r}),t.focusOrder.sort((function(e,t){return e.focusIndex-t.focusIndex})))},t.focusNextElement=function(e){var r=Object(b.a)(t.focusOrder,(function(t){return t.element===e}));if(!(r<0))for(var n=document.activeElement,o=r+1;o<t.focusOrder.length;o++){var a=t.focusOrder[o].element;if(a.focus(),n!==document.activeElement)return void(a.select&&document.activeElement&&"TEXTAREA"!==document.activeElement.tagName&&a.select())}},t.handleExternalCancel=function(){t.props.onExternalCancel()},t.handleNavigation=function(e){if(!it(t.props.changeSet,t.props.originalContact,t.props.editorMode)){var r=t.props.strings.navigationWarning;return e.returnValue=r,r}return null},t}return jo(t,e),t.prototype.render=function(){var e=this;if("idle"===this.props.editorState)return null;var t=this.props.originalContact||{},r=lr(t,this.props.changeSet),n=gt(t,this.props.changeSet),o=ir(t,this.props.changeSet),a=Tt(t,this.props.changeSet),i=function(e,t){return pt(Ct(e),t.updatedEmails)}(t,this.props.changeSet),s=It(t,this.props.changeSet),c=zt(t,this.props.changeSet),p=St(t,this.props.changeSet),m=fr(n)||fr(o)||fr(a)||fr(i)||fr(s)||fr(p)||fr(c),b=t.DisplayNameFirstLast||t.DisplayName||(t.GivenName&&t.Surname?"".concat(t.GivenName," ").concat(t.Surname):void 0),P=n.length>0||i.length>0||p.length>0,S="loading"===this.props.editorState||"loadErrorDialogOpen"===this.props.editorState,E=So(this.props.theme),v=(!i.length||i.some((function(e){return e.isWritable})))&&!t.ADObjectId;this.focusOrder=[];var x=f.c.size100;return y.createElement("main",{id:"lpc-contact-editor",className:E.editorRoot,"data-log-name":"ContactEditor"},y.createElement(ko,{styles:E,strings:this.props.strings,editorMode:this.props.editorMode,containsNonWritable:m,isLinkedContact:Wo(t)}),y.createElement("section",{className:E.rightPane,role:"region","aria-label":this.props.strings.contactEditFormAriaLabel},y.createElement("div",{className:Object(g.a)(E.rightBody,this.formContainer&&this.formContainer.scrollTop>0&&E.rightBodyTopBorder),"data-is-scrollable":"true",onScroll:function(){e.formContainer&&0===e.formContainer.scrollTop===e.formContainer.classList.contains(E.rightBodyTopBorder)&&e.formContainer.classList.toggle(E.rightBodyTopBorder)},ref:function(t){e.formContainer=t}},this.props.errorState&&y.createElement(u.a,{messageBarType:d.a.error,className:E.errorBar},y.createElement("div",{role:"alert",className:E.errorBarMessage},this.props.errorState.message)),S?y.createElement(Xr,{theme:this.props.theme,styling:E.rightBodyContent}):y.createElement("div",{className:E.rightBodyContent},y.createElement(_r,null,y.createElement(zr,null,y.createElement(h.a,{imageUrl:this.props.changeSet.updatedProfilePhoto||(this.props.profilePhotoUrl?this.props.profilePhotoUrl.uri:void 0),size:x,text:b,className:b?"":E.doughboy,hidePersonaDetails:!0}),v&&y.createElement(Mn,{personDisplayName:b||"",personImageUrl:this.props.changeSet.updatedProfilePhoto||this.props.profilePhotoUrl&&this.props.profilePhotoUrl.uri||"",size:x,title:Io(this.props),strings:this.props.strings.photoPickerStrings,onUpload:this.props.onUpdateProfilePhoto})),y.createElement(Sn,{names:r,focusIndex:0,textFieldRef:this.focusRef,strings:this.props.strings,onUpdateName:this.props.onUpdateName,onReturnPressed:this.focusNextElement})),P?y.createElement(Jr,{header:this.props.strings.contactInformation},y.createElement(bn,{emails:i,focusIndex:1,textFieldRef:this.focusRef,strings:this.props.strings,onBlurEmail:this.props.onBlurEmail,onUpdateEmail:this.props.onUpdateEmail,onReturnPressed:this.focusNextElement}),y.createElement(yn,{ims:p,focusIndex:2,textFieldRef:this.focusRef,onUpdateIM:this.props.onUpdateIm,strings:this.props.strings,onReturnPressed:this.focusNextElement}),y.createElement(Un,{phones:n,focusIndex:3,textFieldRef:this.focusRef,strings:this.props.strings,onUpdatePhone:this.props.onUpdatePhone,onReturnPressed:this.focusNextElement})):null,y.createElement(bo,{workDetails:o,focusIndex:4,strings:this.props.strings,textFieldRef:this.focusRef,onUpdateWorkDetail:this.props.onUpdateWorkDetail,onReturnPressed:this.focusNextElement}),y.createElement(Yn,{postalAddresses:a,focusIndex:5,strings:this.props.strings,textFieldRef:this.focusRef,onAddressEditStarted:this.props.onPostalAddressEditStarted,onUpdatePostalAddress:this.props.onUpdatePostalAddress,onReturnPressed:this.focusNextElement}),y.createElement(kn,{otherContactProps:s,focusIndex:6,strings:this.props.strings,focusTargetRef:this.focusRef,onUpdateOtherContactProp:this.props.onUpdateOtherContactProp,onRemoveOtherContactDateProp:this.props.onRemoveOtherContactDateProp,onReturnPressed:this.focusNextElement}),y.createElement(Vn,{notes:c,focusIndex:7,onUpdatePersonalNote:this.props.onUpdatePersonalNote,textFieldRef:this.focusRef,strings:this.props.strings}),y.createElement(Ro,Vo({},this.props)))),y.createElement(co,{className:E.rightFooter,strings:this.props.strings,editorState:this.props.editorState,hasChanges:!it(this.props.changeSet,this.props.originalContact,this.props.editorMode),onSave:this.props.onSaveButtonClick,onCancel:this.props.onCancelButtonClick,onNotSaveInDialog:this.props.onNotSaveButtonInDialogClick,onCancelInDialog:this.props.onCancelButtonInDialogClick,onRetryLoadInDialog:this.props.onRetryLoadInDialogClick,createMode:"AddContact"===this.props.editorMode||"NewContact"===this.props.editorMode,theme:this.props.theme,onSaveButtonFocus:this.props.onResetErrorState,isEnterprise:this.props.isEnterprise}),y.createElement("div",{className:E.closeButtonOuter},y.createElement(l.a,{theme:this.props.theme,className:E.closeButton,ariaLabel:this.props.strings.closeButtonAccessibilityTitle,title:this.props.strings.closeButtonAccessibilityTitle,onClick:this.props.onCancelButtonClick,iconProps:{iconName:"Cancel"},"data-log-name":"ContactEditorClose"}))))},t.prototype.componentDidMount=function(){this.updateComponentRef(void 0,this.props),window.addEventListener("beforeunload",this.handleNavigation),this.updateFocus()},t.prototype.componentWillUnmount=function(){window.removeEventListener("beforeunload",this.handleNavigation),this.props.componentRef&&this.props.componentRef(null)},t.prototype.componentDidUpdate=function(e){if(null!==this.props.errorState&&this.formContainer){this.props.strings.saveErrorDialogTitleError!==this.props.errorState.message||mr(this.props.changeSet)||this.props.onResetErrorState();var t=this.focusTargets[this.props.errorState.propertyUri];t&&(e.errorState&&e.errorState.propertyUri)!==this.props.errorState.propertyUri?t.focus():(e.errorState&&e.errorState.message)!==this.props.errorState.message&&(this.formContainer.scrollTop=0)}else e.focusPropertyUri===this.props.focusPropertyUri&&e.mostRecentPropertyUri===this.props.mostRecentPropertyUri&&e.editorState===this.props.editorState||this.updateFocus()},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.updateComponentRef(this.props,e)},t.prototype.updateComponentRef=function(e,t){var r=this;(!e&&t.componentRef||e&&e.componentRef!==t.componentRef)&&(e&&e.componentRef&&e.componentRef(null),t.componentRef&&t.componentRef({cancel:function(){return r.handleExternalCancel()}}))},t.prototype.updateFocus=function(){var e=this.props.mostRecentPropertyUri&&this.focusTargets[this.props.mostRecentPropertyUri]||this.focusTargets.PersonaGivenNames;e&&setTimeout((function(t){e.focus()}),15)},t}(y.Component);function Wo(e){return!!e&&(e.AttributionsArray?e.AttributionsArray.filter((function(e){return!e.IsHidden&&"RecipientCache"!==e.DisplayName})):[""]).length>1}function Ro(e){var t=e.editorState;if(-1===["saving","failed","discardDialogOpen"].indexOf(t))return null;var r=So(e.theme);return y.createElement(m.a,{"data-log-name":"ContactEditorOverlay",className:r.editorOverlay})}function Io(e){var t=e.changeSet.updatedNames.PersonaGivenNames&&e.changeSet.updatedNames.PersonaGivenNames.newValue||e.originalContact&&e.originalContact.GivenName,r=e.changeSet.updatedNames.PersonaSurnames&&e.changeSet.updatedNames.PersonaSurnames.newValue||e.originalContact&&e.originalContact.Surname,n=t||r,o=e.changeSet.updatedProfilePhoto||e.profilePhotoUrl&&e.profilePhotoUrl.uri;return n?(o?e.strings.changeContactPhotoFor:e.strings.addContactPhotoFor)({p0:t||"",p1:r||""}):o?e.strings.changeContactPhoto:e.strings.addContactPhoto}var Fo=Object(P.c)((function(e,t){var r=Lr.getSelectors(e);return{editorState:r.editorState,originalContact:r.originalContact,changeSet:r.changeSet,errorState:r.errorState,mostRecentPropertyUri:r.mostRecentPropertyUri,strings:To(t.contactEditorStrings)}}),(function(e,t){return{dispatch:e,onUpdateWorkDetail:function(t){return e(G({workDetail:t}))},onUpdateName:function(t,r,n){return e(w({fieldType:t,oldValue:r,newValue:n}))},onUpdatePhone:function(t){return e(j({phone:t}))},onPostalAddressEditStarted:function(t){return e(V({postalAddress:t}))},onUpdatePostalAddress:function(t){return e(U({postalAddress:t}))},onUpdateOtherContactProp:function(t){return e(L({otherContactProp:t}))},onRemoveOtherContactDateProp:function(t){return e(B({otherContactDateProp:t}))},onUpdateIm:function(t){return e(W({im:t}))},onBlurEmail:function(t){return e(I({email:t}))},onUpdateEmail:function(t){return e(F({email:t}))},onUpdatePersonalNote:function(t){return e(Y({note:t}))},onFavoriteStarClicked:function(t){return e(ne({newIsFavoriteValue:t}))},onUpdateProfilePhoto:function(t){return e(oe({dataUri:t}))},onResetErrorState:function(){return e(ae())}}}),(function(e,t,r){var n=Vo(Vo(Vo({},r),e),t);return Vo(Vo({},n),{onSaveButtonClick:function(){return function(e,t){if("saving"===t.editorState)return;var r=mr(t.changeSet);r?e(K({message:t.strings.saveErrorDialogTitleError,propertyUri:r})):(e(z()),function(e,t){Do(this,void 0,void 0,(function(){var r,n;return Uo(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t.saveChanges(t.originalContact&&t.originalContact.PersonaId&&t.originalContact.PersonaId.Id||null,t.originalContact,(a=Xt(t.changeSet,t.originalContact||void 0),a.map((function(e){return"PersonaBodies"===e.propertyUri?et(et({},e),{newValue:e.newValue||" "}):e}))),t.changeSet.updatedProfilePhoto)];case 1:return(r=o.sent()).success?(t.onClose(r.owsPersona&&r.owsPersona.PersonaId&&r.owsPersona.PersonaId.Id||null),e(ee())):e(re({error:r.message})),[3,3];case 2:return n=o.sent(),e(re({error:Bo(n)})),[3,3];case 3:return[2]}var a}))}))}(e,t))}(t.dispatch,n)},onCancelButtonClick:function(){return function(e,t){e(X()),Lo(e,t,!1)}(t.dispatch,n)},onNotSaveButtonInDialogClick:function(){return function(e,t){e($()),Lo(e,t,!0)}(t.dispatch,n)},onCancelButtonInDialogClick:function(){return function(e,t){"loadErrorDialogOpen"===t.editorState&&Lo(e,t,!0);e(q())}(t.dispatch,n)},onRetryLoadInDialogClick:function(){return function(e,t){e(J()),t.onRetryLoad()}(t.dispatch,n)},onExternalCancel:function(){return function(e,t){e(Z()),Lo(e,t,!1)}(t.dispatch,n)}})}))(Object(c.a)(Mo)),Ho=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getOriginalContact=function(){return Do(t,void 0,void 0,(function(){var e,t,r,a,s;return Uo(this,(function(c){switch(c.label){case 0:e=Object(i.b)(this).reduxStore||Object(n.throwError)("redux store not found"),t=e.dispatch,r=void 0,a=void 0,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.props.getOriginalContact()];case 2:return r=c.sent(),[3,4];case 3:return s=c.sent(),a=s,[3,4];case 4:switch(this.props.editorMode){case"AddContact":r&&t(O({originalContact:r})),t(A({originalContact:null}));break;case"NewContact":t(A({originalContact:null}));break;case"EditContact":a?t(N({error:Bo(a)})):r?r.PersonaId&&r.PersonaId.Id?t(A({originalContact:r,focusPropertyUri:this.props.focusPropertyUri})):t(N({error:"GetOriginalContactReturnedEmptyPersona"})):t(N({error:"GetOriginalContactReturnedNull"}));break;default:return[2,Object(o.a)(this.props.editorMode)]}return[2]}}))}))},t}return jo(t,e),t.prototype.UNSAFE_componentWillMount=function(){this.props.isOpen&&this.startEditing()},t.prototype.UNSAFE_componentWillReceiveProps=function(e){!this.props.isOpen&&e.isOpen&&this.startEditing()},t.prototype.render=function(){var e=this.props.isOpen?y.createElement(Fo,Vo({},this.props,{onRetryLoad:this.getOriginalContact})):null;return y.createElement(p.a,{isBlocking:!0,isOpen:this.props.isOpen,className:"lpc_nested_popup",titleAriaId:"lpc-contact-editor-title"},e)},t.prototype.startEditing=function(){var e=Object(i.b)(this).reduxStore||Object(n.throwError)("redux store not found");"NewContact"===this.props.editorMode?e.dispatch(x({focusPropertyUri:this.props.focusPropertyUri||null,initialValues:this.props.initialValues||[]})):(e.dispatch(v({focusPropertyUri:this.props.focusPropertyUri||null})),this.getOriginalContact())},t.contextTypes=Vo({},s.b),t}(y.Component)}}]);